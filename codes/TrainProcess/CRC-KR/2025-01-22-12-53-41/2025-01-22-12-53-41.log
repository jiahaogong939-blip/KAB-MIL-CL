[2025-01-22 12:53:41,662][INFO] Running PROJECT: CRC-KR, P LEARNING RATE: 0.001, OPTIMIZER: ADAMW, NUM EPOCHS: 30, BATCH SIZE: 2048, DEVICES: cuda, SMOOTHING: 0.1
[2025-01-22 12:53:41,662][INFO] params["in_chans"]=[200, 16]python run_MIL_model.py --proj CRC-KR  --num_epochs 30  --plr 1e-3  --smoothing 0.1
[2025-01-22 12:53:41,663][INFO] params["dims"]=[512, 512]温度参数为0.55
[2025-01-22 12:53:41,663][INFO] params["out_chans"]=[16, 8]
[2025-01-22 12:53:41,663][INFO] params["heads"]=[8, 4]
[2025-01-22 12:53:41,663][INFO] params["dropout"]=[0.8, 0.4, 0.4]
[2025-01-22 12:55:39,339][INFO] Epoch[1/30], loss:1.8126, CE loss:0.8035 , info NCE loss:7.5306
[2025-01-22 12:55:39,339][INFO] Epoch[1/30], train B-acc: 0.5119(0.5000-0.5408), test B-acc: 0.4938(0.4800-0.5000)
[2025-01-22 12:55:39,339][INFO] Epoch[1/30], train AUC: 0.7665(0.6919-0.8369), test AUC: 0.6247(0.5046-0.7431)
[2025-01-22 12:57:56,075][INFO] Epoch[2/30], loss:1.4869, CE loss:0.4912 , info NCE loss:7.1287
[2025-01-22 12:57:56,075][INFO] Epoch[2/30], train B-acc: 0.5000(0.5000-0.5000), test B-acc: 0.5000(0.5000-0.5000)
[2025-01-22 12:57:56,075][INFO] Epoch[2/30], train AUC: 0.7965(0.7232-0.8649), test AUC: 0.6895(0.5734-0.7909)
[2025-01-22 13:00:04,913][INFO] Epoch[3/30], loss:1.4133, CE loss:0.4382 , info NCE loss:6.9388
[2025-01-22 13:00:04,915][INFO] Epoch[3/30], train B-acc: 0.5413(0.5041-0.5948), test B-acc: 0.4938(0.4789-0.5000)
[2025-01-22 13:00:04,915][INFO] Epoch[3/30], train AUC: 0.8206(0.7472-0.8822), test AUC: 0.7105(0.5933-0.8232)
[2025-01-22 13:02:10,589][INFO] Epoch[4/30], loss:1.3816, CE loss:0.4194 , info NCE loss:6.8341
[2025-01-22 13:02:10,589][INFO] Epoch[4/30], train B-acc: 0.5694(0.5187-0.6274), test B-acc: 0.5097(0.4863-0.5517)
[2025-01-22 13:02:10,591][INFO] Epoch[4/30], train AUC: 0.8390(0.7710-0.8949), test AUC: 0.7345(0.6142-0.8337)
[2025-01-22 13:04:13,861][INFO] Epoch[5/30], loss:1.3668, CE loss:0.4093 , info NCE loss:6.7925
[2025-01-22 13:04:13,861][INFO] Epoch[5/30], train B-acc: 0.5914(0.5387-0.6587), test B-acc: 0.5234(0.4880-0.5806)
[2025-01-22 13:04:13,861][INFO] Epoch[5/30], train AUC: 0.8660(0.7985-0.9173), test AUC: 0.7468(0.6346-0.8457)
[2025-01-22 13:06:19,357][INFO] Epoch[6/30], loss:1.3522, CE loss:0.3987 , info NCE loss:6.7553
[2025-01-22 13:06:19,357][INFO] Epoch[6/30], train B-acc: 0.6186(0.5547-0.6884), test B-acc: 0.5361(0.4865-0.6014)
[2025-01-22 13:06:19,357][INFO] Epoch[6/30], train AUC: 0.8918(0.8372-0.9362), test AUC: 0.7687(0.6575-0.8667)
[2025-01-22 13:08:26,103][INFO] Epoch[7/30], loss:1.3421, CE loss:0.3900 , info NCE loss:6.7375
[2025-01-22 13:08:26,104][INFO] Epoch[7/30], train B-acc: 0.6522(0.5835-0.7261), test B-acc: 0.5954(0.5215-0.6743)
[2025-01-22 13:08:26,104][INFO] Epoch[7/30], train AUC: 0.9088(0.8595-0.9472), test AUC: 0.7830(0.6691-0.8789)
[2025-01-22 13:10:29,941][INFO] Epoch[8/30], loss:1.3315, CE loss:0.3801 , info NCE loss:6.7223
[2025-01-22 13:10:29,941][INFO] Epoch[8/30], train B-acc: 0.6490(0.5784-0.7232), test B-acc: 0.5843(0.5124-0.6675)
[2025-01-22 13:10:29,941][INFO] Epoch[8/30], train AUC: 0.9197(0.8781-0.9571), test AUC: 0.7915(0.6790-0.8829)
[2025-01-22 13:12:33,994][INFO] Epoch[9/30], loss:1.3214, CE loss:0.3707 , info NCE loss:6.7087
[2025-01-22 13:12:33,994][INFO] Epoch[9/30], train B-acc: 0.7329(0.6502-0.8078), test B-acc: 0.5963(0.5211-0.6821)
[2025-01-22 13:12:33,994][INFO] Epoch[9/30], train AUC: 0.9307(0.8900-0.9613), test AUC: 0.7957(0.7005-0.8803)
[2025-01-22 13:14:37,234][INFO] Epoch[10/30], loss:1.3136, CE loss:0.3627 , info NCE loss:6.7020
[2025-01-22 13:14:37,234][INFO] Epoch[10/30], train B-acc: 0.7359(0.6522-0.8202), test B-acc: 0.5954(0.5138-0.6791)
[2025-01-22 13:14:37,234][INFO] Epoch[10/30], train AUC: 0.9434(0.9073-0.9706), test AUC: 0.8031(0.7035-0.8868)
[2025-01-22 13:16:39,882][INFO] Epoch[11/30], loss:1.3059, CE loss:0.3542 , info NCE loss:6.6987
[2025-01-22 13:16:39,882][INFO] Epoch[11/30], train B-acc: 0.7940(0.7172-0.8639), test B-acc: 0.5948(0.5106-0.6834)
[2025-01-22 13:16:39,882][INFO] Epoch[11/30], train AUC: 0.9521(0.9227-0.9759), test AUC: 0.8034(0.7023-0.8960)
[2025-01-22 13:18:45,137][INFO] Epoch[12/30], loss:1.2984, CE loss:0.3466 , info NCE loss:6.6918
[2025-01-22 13:18:45,137][INFO] Epoch[12/30], train B-acc: 0.8389(0.7630-0.9040), test B-acc: 0.6147(0.5245-0.7099)
[2025-01-22 13:18:45,137][INFO] Epoch[12/30], train AUC: 0.9592(0.9289-0.9808), test AUC: 0.8025(0.7068-0.8859)
[2025-01-22 13:20:48,762][INFO] Epoch[13/30], loss:1.2910, CE loss:0.3391 , info NCE loss:6.6852
[2025-01-22 13:20:48,762][INFO] Epoch[13/30], train B-acc: 0.8898(0.8317-0.9452), test B-acc: 0.6664(0.5693-0.7562)
[2025-01-22 13:20:48,762][INFO] Epoch[13/30], train AUC: 0.9646(0.9405-0.9859), test AUC: 0.7950(0.6906-0.8780)
[2025-01-22 13:22:50,824][INFO] Epoch[14/30], loss:1.2843, CE loss:0.3321 , info NCE loss:6.6801
[2025-01-22 13:22:50,825][INFO] Epoch[14/30], train B-acc: 0.9216(0.8679-0.9696), test B-acc: 0.6634(0.5736-0.7574)
[2025-01-22 13:22:50,825][INFO] Epoch[14/30], train AUC: 0.9729(0.9523-0.9889), test AUC: 0.7933(0.7012-0.8757)
[2025-01-22 13:24:51,273][INFO] Epoch[15/30], loss:1.2781, CE loss:0.3250 , info NCE loss:6.6787
[2025-01-22 13:24:51,273][INFO] Epoch[15/30], train B-acc: 0.9312(0.8770-0.9728), test B-acc: 0.6721(0.5715-0.7720)
[2025-01-22 13:24:51,273][INFO] Epoch[15/30], train AUC: 0.9779(0.9583-0.9917), test AUC: 0.7878(0.6784-0.8765)
[2025-01-22 13:26:57,707][INFO] Epoch[16/30], loss:1.2724, CE loss:0.3189 , info NCE loss:6.6755
[2025-01-22 13:26:57,707][INFO] Epoch[16/30], train B-acc: 0.9097(0.8658-0.9439), test B-acc: 0.7301(0.6327-0.8243)
[2025-01-22 13:26:57,707][INFO] Epoch[16/30], train AUC: 0.9812(0.9653-0.9935), test AUC: 0.7841(0.6849-0.8664)
[2025-01-22 13:27:55,228][INFO] Epoch 17 retry 1 of 5, loss did not decrease.
[2025-01-22 13:29:49,379][INFO] Epoch[17/30], loss:1.2645, CE loss:0.3106 , info NCE loss:6.6698
[2025-01-22 13:29:49,379][INFO] Epoch[17/30], train B-acc: 0.9441(0.9025-0.9742), test B-acc: 0.6802(0.5733-0.7741)
[2025-01-22 13:29:49,379][INFO] Epoch[17/30], train AUC: 0.9896(0.9767-0.9969), test AUC: 0.7752(0.6584-0.8649)
[2025-01-22 13:31:52,874][INFO] Epoch[18/30], loss:1.2568, CE loss:0.3016 , info NCE loss:6.6696
[2025-01-22 13:31:52,874][INFO] Epoch[18/30], train B-acc: 0.9470(0.9117-0.9711), test B-acc: 0.6973(0.6000-0.7954)
[2025-01-22 13:31:52,874][INFO] Epoch[18/30], train AUC: 0.9907(0.9784-0.9975), test AUC: 0.7714(0.6689-0.8578)
[2025-01-22 13:33:54,088][INFO] Epoch[19/30], loss:1.2530, CE loss:0.2980 , info NCE loss:6.6644
[2025-01-22 13:33:54,089][INFO] Epoch[19/30], train B-acc: 0.9448(0.9102-0.9686), test B-acc: 0.6970(0.5862-0.7852)
[2025-01-22 13:33:54,089][INFO] Epoch[19/30], train AUC: 0.9921(0.9818-0.9981), test AUC: 0.7735(0.6643-0.8579)
[2025-01-22 13:35:58,322][INFO] Epoch[20/30], loss:1.2473, CE loss:0.2917 , info NCE loss:6.6621
[2025-01-22 13:35:58,323][INFO] Epoch[20/30], train B-acc: 0.9498(0.9304-0.9679), test B-acc: 0.6715(0.5757-0.7729)
[2025-01-22 13:35:58,323][INFO] Epoch[20/30], train AUC: 0.9933(0.9841-0.9988), test AUC: 0.7690(0.6667-0.8660)
[2025-01-22 13:38:04,511][INFO] Epoch[21/30], loss:1.2416, CE loss:0.2861 , info NCE loss:6.6565
[2025-01-22 13:38:04,511][INFO] Epoch[21/30], train B-acc: 0.9229(0.8983-0.9457), test B-acc: 0.7009(0.5931-0.7918)
[2025-01-22 13:38:04,511][INFO] Epoch[21/30], train AUC: 0.9940(0.9849-0.9990), test AUC: 0.7734(0.6627-0.8628)
[2025-01-22 13:40:09,354][INFO] Epoch[22/30], loss:1.2384, CE loss:0.2821 , info NCE loss:6.6576
[2025-01-22 13:40:09,354][INFO] Epoch[22/30], train B-acc: 0.9242(0.9030-0.9454), test B-acc: 0.6782(0.5758-0.7792)
[2025-01-22 13:40:09,354][INFO] Epoch[22/30], train AUC: 0.9950(0.9870-0.9997), test AUC: 0.7675(0.6619-0.8584)
[2025-01-22 13:41:06,844][INFO] Epoch 23 retry 1 of 5, loss did not decrease.
[2025-01-22 13:41:52,443][INFO] Epoch 23 retry 2 of 5, loss did not decrease.
[2025-01-22 13:43:46,602][INFO] Epoch[23/30], loss:1.2306, CE loss:0.2738 , info NCE loss:6.6524
[2025-01-22 13:43:46,602][INFO] Epoch[23/30], train B-acc: 0.8849(0.8560-0.9105), test B-acc: 0.6975(0.6009-0.7768)
[2025-01-22 13:43:46,602][INFO] Epoch[23/30], train AUC: 0.9955(0.9874-0.9995), test AUC: 0.7561(0.6496-0.8466)
[2025-01-22 13:45:51,503][INFO] Epoch[24/30], loss:1.2232, CE loss:0.2659 , info NCE loss:6.6479
[2025-01-22 13:45:51,504][INFO] Epoch[24/30], train B-acc: 0.8922(0.8657-0.9184), test B-acc: 0.6846(0.5911-0.7769)
[2025-01-22 13:45:51,504][INFO] Epoch[24/30], train AUC: 0.9959(0.9887-0.9999), test AUC: 0.7552(0.6544-0.8573)
[2025-01-22 13:47:58,997][INFO] Epoch[25/30], loss:1.2191, CE loss:0.2618 , info NCE loss:6.6441
[2025-01-22 13:47:58,997][INFO] Epoch[25/30], train B-acc: 0.8690(0.8408-0.8979), test B-acc: 0.7024(0.6112-0.7742)
[2025-01-22 13:47:58,998][INFO] Epoch[25/30], train AUC: 0.9964(0.9904-1.0000), test AUC: 0.7550(0.6440-0.8533)
[2025-01-22 13:50:00,192][INFO] Epoch[26/30], loss:1.2185, CE loss:0.2609 , info NCE loss:6.6448
[2025-01-22 13:50:00,192][INFO] Epoch[26/30], train B-acc: 0.9414(0.9213-0.9622), test B-acc: 0.6597(0.5621-0.7581)
[2025-01-22 13:50:00,192][INFO] Epoch[26/30], train AUC: 0.9960(0.9894-0.9998), test AUC: 0.7496(0.6499-0.8516)
[2025-01-22 13:50:55,243][INFO] Epoch 27 retry 1 of 5, loss did not decrease.
[2025-01-22 13:51:42,139][INFO] Epoch 27 retry 2 of 5, loss did not decrease.
[2025-01-22 13:52:29,851][INFO] Epoch 27 retry 3 of 5, loss did not decrease.
[2025-01-22 13:53:15,625][INFO] Epoch 27 retry 4 of 5, loss did not decrease.
[2025-01-22 13:54:01,942][INFO] Epoch 27 retry 5 of 5, loss did not decrease.
[2025-01-22 13:54:01,942][WARNING] Epoch 27 failed to decrease loss after 5 retries.
[2025-01-22 13:55:10,210][INFO] Epoch[27/30], loss:1.2261, CE loss:0.2681 , info NCE loss:6.6548
[2025-01-22 13:55:10,211][INFO] Epoch[27/30], train B-acc: 0.9160(0.8917-0.9388), test B-acc: 0.7051(0.6077-0.7894)
[2025-01-22 13:55:10,211][INFO] Epoch[27/30], train AUC: 0.9950(0.9878-0.9993), test AUC: 0.7624(0.6461-0.8596)
[2025-01-22 13:57:16,482][INFO] Epoch[28/30], loss:1.2199, CE loss:0.2612 , info NCE loss:6.6527
[2025-01-22 13:57:16,482][INFO] Epoch[28/30], train B-acc: 0.8820(0.8544-0.9076), test B-acc: 0.6824(0.5952-0.7590)
[2025-01-22 13:57:16,482][INFO] Epoch[28/30], train AUC: 0.9952(0.9881-0.9994), test AUC: 0.7622(0.6490-0.8549)
[2025-01-22 13:59:20,065][INFO] Epoch[29/30], loss:1.2169, CE loss:0.2582 , info NCE loss:6.6497
[2025-01-22 13:59:20,066][INFO] Epoch[29/30], train B-acc: 0.8624(0.8347-0.8909), test B-acc: 0.6640(0.5795-0.7447)
[2025-01-22 13:59:20,066][INFO] Epoch[29/30], train AUC: 0.9958(0.9893-0.9998), test AUC: 0.7624(0.6502-0.8497)
[2025-01-22 14:01:22,903][INFO] Epoch[30/30], loss:1.2148, CE loss:0.2558 , info NCE loss:6.6492
[2025-01-22 14:01:22,903][INFO] Epoch[30/30], train B-acc: 0.8755(0.8475-0.9034), test B-acc: 0.6762(0.5933-0.7573)
[2025-01-22 14:01:22,903][INFO] Epoch[30/30], train AUC: 0.9958(0.9890-0.9999), test AUC: 0.7583(0.6549-0.8559)
