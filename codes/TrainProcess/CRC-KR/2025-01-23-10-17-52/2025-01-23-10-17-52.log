[2025-01-23 10:17:52,131][INFO] Running PROJECT: CRC-KR, P LEARNING RATE: 0.0001, OPTIMIZER: ADAMW, NUM EPOCHS: 30, BATCH SIZE: 2048, DEVICES: cuda, SMOOTHING: 0.25
[2025-01-23 10:17:52,131][INFO] params["in_chans"]=[200, 16]python run_MIL_model.py --proj CRC-KR --num_epochs 30 --plr 1e-4  --smoothing 0.25
[2025-01-23 10:17:52,132][INFO] params["dims"]=[512, 512]温度参数为0.52
[2025-01-23 10:17:52,132][INFO] params["out_chans"]=[16, 8]
[2025-01-23 10:17:52,132][INFO] params["heads"]=[8, 4]
[2025-01-23 10:17:52,132][INFO] params["dropout"]=[0.8, 0.4, 0.4]
[2025-01-23 10:19:50,133][INFO] Epoch[1/30], loss:0.7469, CE loss:0.5783 , info NCE loss:0.5720
[2025-01-23 10:19:50,133][INFO] Epoch[1/30], train B-acc: 0.5000(0.5000-0.5000), test B-acc: 0.5000(0.5000-0.5000)
[2025-01-23 10:19:50,134][INFO] Epoch[1/30], train AUC: 0.5754(0.4696-0.6707), test AUC: 0.5996(0.4713-0.7328)
[2025-01-23 10:22:19,754][INFO] Epoch[2/30], loss:0.7118, CE loss:0.5438 , info NCE loss:0.5687
[2025-01-23 10:22:19,754][INFO] Epoch[2/30], train B-acc: 0.5000(0.5000-0.5000), test B-acc: 0.5000(0.5000-0.5000)
[2025-01-23 10:22:19,754][INFO] Epoch[2/30], train AUC: 0.7179(0.6308-0.7933), test AUC: 0.6414(0.5186-0.7565)
[2025-01-23 10:24:35,635][INFO] Epoch[3/30], loss:0.6979, CE loss:0.5313 , info NCE loss:0.5612
[2025-01-23 10:24:35,635][INFO] Epoch[3/30], train B-acc: 0.5000(0.5000-0.5000), test B-acc: 0.5000(0.5000-0.5000)
[2025-01-23 10:24:35,635][INFO] Epoch[3/30], train AUC: 0.7631(0.6855-0.8265), test AUC: 0.6578(0.5284-0.7638)
[2025-01-23 10:26:48,361][INFO] Epoch[4/30], loss:0.6888, CE loss:0.5248 , info NCE loss:0.5508
[2025-01-23 10:26:48,362][INFO] Epoch[4/30], train B-acc: 0.5000(0.5000-0.5000), test B-acc: 0.5000(0.5000-0.5000)
[2025-01-23 10:26:48,362][INFO] Epoch[4/30], train AUC: 0.7895(0.7173-0.8546), test AUC: 0.6754(0.5576-0.7915)
[2025-01-23 10:28:51,063][INFO] Epoch[5/30], loss:0.6803, CE loss:0.5199 , info NCE loss:0.5363
[2025-01-23 10:28:51,064][INFO] Epoch[5/30], train B-acc: 0.5092(0.4937-0.5395), test B-acc: 0.5000(0.5000-0.5000)
[2025-01-23 10:28:51,064][INFO] Epoch[5/30], train AUC: 0.8102(0.7341-0.8735), test AUC: 0.6931(0.5690-0.8044)
[2025-01-23 10:30:53,373][INFO] Epoch[6/30], loss:0.6737, CE loss:0.5158 , info NCE loss:0.5316
[2025-01-23 10:30:53,373][INFO] Epoch[6/30], train B-acc: 0.5216(0.4959-0.5637), test B-acc: 0.5000(0.5000-0.5000)
[2025-01-23 10:30:53,373][INFO] Epoch[6/30], train AUC: 0.8293(0.7611-0.8854), test AUC: 0.7148(0.5957-0.8181)
[2025-01-23 10:32:57,994][INFO] Epoch[7/30], loss:0.6689, CE loss:0.5121 , info NCE loss:0.5304
[2025-01-23 10:32:57,994][INFO] Epoch[7/30], train B-acc: 0.5427(0.5047-0.5947), test B-acc: 0.5156(0.5000-0.5556)
[2025-01-23 10:32:57,994][INFO] Epoch[7/30], train AUC: 0.8464(0.7795-0.9017), test AUC: 0.7274(0.6127-0.8354)
[2025-01-23 10:35:02,534][INFO] Epoch[8/30], loss:0.6645, CE loss:0.5083 , info NCE loss:0.5284
[2025-01-23 10:35:02,535][INFO] Epoch[8/30], train B-acc: 0.5455(0.5074-0.5984), test B-acc: 0.5000(0.5000-0.5000)
[2025-01-23 10:35:02,535][INFO] Epoch[8/30], train AUC: 0.8650(0.8075-0.9152), test AUC: 0.7446(0.6262-0.8505)
[2025-01-23 10:37:07,057][INFO] Epoch[9/30], loss:0.6603, CE loss:0.5044 , info NCE loss:0.5277
[2025-01-23 10:37:07,057][INFO] Epoch[9/30], train B-acc: 0.5459(0.5080-0.6000), test B-acc: 0.5161(0.5000-0.5556)
[2025-01-23 10:37:07,057][INFO] Epoch[9/30], train AUC: 0.8793(0.8266-0.9277), test AUC: 0.7541(0.6368-0.8587)
[2025-01-23 10:39:08,546][INFO] Epoch[10/30], loss:0.6563, CE loss:0.5008 , info NCE loss:0.5255
[2025-01-23 10:39:08,546][INFO] Epoch[10/30], train B-acc: 0.5547(0.5111-0.6111), test B-acc: 0.5156(0.5000-0.5536)
[2025-01-23 10:39:08,547][INFO] Epoch[10/30], train AUC: 0.8930(0.8419-0.9347), test AUC: 0.7650(0.6459-0.8618)
[2025-01-23 10:41:09,297][INFO] Epoch[11/30], loss:0.6530, CE loss:0.4977 , info NCE loss:0.5237
[2025-01-23 10:41:09,297][INFO] Epoch[11/30], train B-acc: 0.5833(0.5269-0.6420), test B-acc: 0.5312(0.5000-0.5833)
[2025-01-23 10:41:09,297][INFO] Epoch[11/30], train AUC: 0.9055(0.8549-0.9424), test AUC: 0.7662(0.6506-0.8724)
[2025-01-23 10:43:10,427][INFO] Epoch[12/30], loss:0.6496, CE loss:0.4945 , info NCE loss:0.5239
[2025-01-23 10:43:10,428][INFO] Epoch[12/30], train B-acc: 0.6047(0.5467-0.6714), test B-acc: 0.5312(0.5000-0.5806)
[2025-01-23 10:43:10,428][INFO] Epoch[12/30], train AUC: 0.9125(0.8666-0.9475), test AUC: 0.7728(0.6678-0.8716)
[2025-01-23 10:45:10,370][INFO] Epoch[13/30], loss:0.6460, CE loss:0.4910 , info NCE loss:0.5221
[2025-01-23 10:45:10,371][INFO] Epoch[13/30], train B-acc: 0.6163(0.5530-0.6855), test B-acc: 0.5437(0.4941-0.6065)
[2025-01-23 10:45:10,371][INFO] Epoch[13/30], train AUC: 0.9196(0.8764-0.9533), test AUC: 0.7797(0.6614-0.8760)
[2025-01-23 10:47:10,976][INFO] Epoch[14/30], loss:0.6433, CE loss:0.4886 , info NCE loss:0.5219
[2025-01-23 10:47:10,976][INFO] Epoch[14/30], train B-acc: 0.6291(0.5673-0.7031), test B-acc: 0.5683(0.5063-0.6437)
[2025-01-23 10:47:10,976][INFO] Epoch[14/30], train AUC: 0.9250(0.8833-0.9580), test AUC: 0.7819(0.6738-0.8759)
[2025-01-23 10:49:11,264][INFO] Epoch[15/30], loss:0.6405, CE loss:0.4860 , info NCE loss:0.5219
[2025-01-23 10:49:11,264][INFO] Epoch[15/30], train B-acc: 0.6286(0.5674-0.7029), test B-acc: 0.5707(0.5086-0.6469)
[2025-01-23 10:49:11,264][INFO] Epoch[15/30], train AUC: 0.9288(0.8919-0.9608), test AUC: 0.7873(0.6835-0.8779)
[2025-01-23 10:51:12,255][INFO] Epoch[16/30], loss:0.6376, CE loss:0.4833 , info NCE loss:0.5224
[2025-01-23 10:51:12,255][INFO] Epoch[16/30], train B-acc: 0.6279(0.5672-0.6965), test B-acc: 0.5420(0.4951-0.6071)
[2025-01-23 10:51:12,255][INFO] Epoch[16/30], train AUC: 0.9350(0.8990-0.9629), test AUC: 0.7911(0.6772-0.8781)
[2025-01-23 10:53:16,456][INFO] Epoch[17/30], loss:0.6355, CE loss:0.4814 , info NCE loss:0.5187
[2025-01-23 10:53:16,456][INFO] Epoch[17/30], train B-acc: 0.6415(0.5754-0.7162), test B-acc: 0.5594(0.5072-0.6333)
[2025-01-23 10:53:16,456][INFO] Epoch[17/30], train AUC: 0.9411(0.9067-0.9691), test AUC: 0.7974(0.6887-0.8830)
[2025-01-23 10:55:36,560][INFO] Epoch[18/30], loss:0.6318, CE loss:0.4780 , info NCE loss:0.5182
[2025-01-23 10:55:36,560][INFO] Epoch[18/30], train B-acc: 0.6665(0.5931-0.7432), test B-acc: 0.5881(0.5172-0.6667)
[2025-01-23 10:55:36,560][INFO] Epoch[18/30], train AUC: 0.9441(0.9083-0.9693), test AUC: 0.7966(0.6948-0.8860)
[2025-01-23 10:58:10,909][INFO] Epoch[19/30], loss:0.6299, CE loss:0.4762 , info NCE loss:0.5181
[2025-01-23 10:58:10,909][INFO] Epoch[19/30], train B-acc: 0.6818(0.6072-0.7534), test B-acc: 0.5862(0.5103-0.6714)
[2025-01-23 10:58:10,909][INFO] Epoch[19/30], train AUC: 0.9476(0.9153-0.9735), test AUC: 0.8008(0.7000-0.8814)
[2025-01-23 11:00:42,961][INFO] Epoch[20/30], loss:0.6283, CE loss:0.4747 , info NCE loss:0.5167
[2025-01-23 11:00:42,961][INFO] Epoch[20/30], train B-acc: 0.7024(0.6258-0.7788), test B-acc: 0.5865(0.5194-0.6610)
[2025-01-23 11:00:42,962][INFO] Epoch[20/30], train AUC: 0.9518(0.9224-0.9763), test AUC: 0.7995(0.6941-0.8838)
[2025-01-23 11:03:15,125][INFO] Epoch[21/30], loss:0.6259, CE loss:0.4727 , info NCE loss:0.5151
[2025-01-23 11:03:15,125][INFO] Epoch[21/30], train B-acc: 0.7275(0.6497-0.8056), test B-acc: 0.5949(0.5257-0.6803)
[2025-01-23 11:03:15,125][INFO] Epoch[21/30], train AUC: 0.9539(0.9197-0.9772), test AUC: 0.7999(0.6984-0.8831)
[2025-01-23 11:05:47,810][INFO] Epoch[22/30], loss:0.6239, CE loss:0.4708 , info NCE loss:0.5157
[2025-01-23 11:05:47,810][INFO] Epoch[22/30], train B-acc: 0.7611(0.6862-0.8371), test B-acc: 0.5837(0.5068-0.6694)
[2025-01-23 11:05:47,810][INFO] Epoch[22/30], train AUC: 0.9560(0.9270-0.9783), test AUC: 0.8052(0.6883-0.8908)
[2025-01-23 11:08:19,661][INFO] Epoch[23/30], loss:0.6220, CE loss:0.4691 , info NCE loss:0.5173
[2025-01-23 11:08:19,661][INFO] Epoch[23/30], train B-acc: 0.7363(0.6539-0.8122), test B-acc: 0.5973(0.5205-0.6772)
[2025-01-23 11:08:19,662][INFO] Epoch[23/30], train AUC: 0.9598(0.9328-0.9797), test AUC: 0.8003(0.6974-0.8831)
[2025-01-23 11:10:49,705][INFO] Epoch[24/30], loss:0.6198, CE loss:0.4671 , info NCE loss:0.5172
[2025-01-23 11:10:49,705][INFO] Epoch[24/30], train B-acc: 0.7867(0.7078-0.8601), test B-acc: 0.5854(0.5080-0.6740)
[2025-01-23 11:10:49,706][INFO] Epoch[24/30], train AUC: 0.9607(0.9338-0.9818), test AUC: 0.8021(0.7049-0.8852)
[2025-01-23 11:12:47,231][INFO] Epoch[25/30], loss:0.6179, CE loss:0.4654 , info NCE loss:0.5135
[2025-01-23 11:12:47,232][INFO] Epoch[25/30], train B-acc: 0.8078(0.7305-0.8807), test B-acc: 0.6001(0.5235-0.6859)
[2025-01-23 11:12:47,232][INFO] Epoch[25/30], train AUC: 0.9629(0.9334-0.9828), test AUC: 0.8030(0.7062-0.8866)
[2025-01-23 11:14:44,378][INFO] Epoch[26/30], loss:0.6164, CE loss:0.4640 , info NCE loss:0.5150
[2025-01-23 11:14:44,378][INFO] Epoch[26/30], train B-acc: 0.7611(0.6839-0.8330), test B-acc: 0.5949(0.5167-0.6739)
[2025-01-23 11:14:44,378][INFO] Epoch[26/30], train AUC: 0.9643(0.9385-0.9834), test AUC: 0.8017(0.7034-0.8805)
[2025-01-23 11:16:41,426][INFO] Epoch[27/30], loss:0.6159, CE loss:0.4636 , info NCE loss:0.5158
[2025-01-23 11:16:41,426][INFO] Epoch[27/30], train B-acc: 0.7873(0.7079-0.8608), test B-acc: 0.5985(0.5267-0.6852)
[2025-01-23 11:16:41,426][INFO] Epoch[27/30], train AUC: 0.9661(0.9416-0.9852), test AUC: 0.8022(0.6982-0.8792)
[2025-01-23 11:18:39,747][INFO] Epoch[28/30], loss:0.6134, CE loss:0.4614 , info NCE loss:0.5118
[2025-01-23 11:18:39,747][INFO] Epoch[28/30], train B-acc: 0.8118(0.7310-0.8789), test B-acc: 0.6271(0.5422-0.7229)
[2025-01-23 11:18:39,747][INFO] Epoch[28/30], train AUC: 0.9684(0.9434-0.9863), test AUC: 0.7966(0.6933-0.8842)
[2025-01-23 11:20:38,717][INFO] Epoch[29/30], loss:0.6113, CE loss:0.4593 , info NCE loss:0.5110
[2025-01-23 11:20:38,718][INFO] Epoch[29/30], train B-acc: 0.8097(0.7323-0.8815), test B-acc: 0.5832(0.5079-0.6776)
[2025-01-23 11:20:38,718][INFO] Epoch[29/30], train AUC: 0.9688(0.9453-0.9862), test AUC: 0.7970(0.6985-0.8824)
[2025-01-23 11:22:36,265][INFO] Epoch[30/30], loss:0.6101, CE loss:0.4583 , info NCE loss:0.5104
[2025-01-23 11:22:36,265][INFO] Epoch[30/30], train B-acc: 0.8190(0.7453-0.8951), test B-acc: 0.6274(0.5460-0.7247)
[2025-01-23 11:22:36,266][INFO] Epoch[30/30], train AUC: 0.9713(0.9483-0.9862), test AUC: 0.7984(0.7074-0.8821)
