[2025-01-22 14:03:47,182][INFO] Running PROJECT: CRC-KR, P LEARNING RATE: 0.001, OPTIMIZER: ADAMW, NUM EPOCHS: 30, BATCH SIZE: 2048, DEVICES: cuda, SMOOTHING: 0.3
[2025-01-22 14:03:47,182][INFO] params["in_chans"]=[200, 16]python run_MIL_model.py --proj CRC-KR  --num_epochs 30  --plr 1e-3  --smoothing 0.3
[2025-01-22 14:03:47,182][INFO] params["dims"]=[512, 512]温度参数为0.55
[2025-01-22 14:03:47,183][INFO] params["out_chans"]=[16, 8]
[2025-01-22 14:03:47,183][INFO] params["heads"]=[8, 4]
[2025-01-22 14:03:47,183][INFO] params["dropout"]=[0.8, 0.4, 0.4]
[2025-01-22 14:05:45,658][INFO] Epoch[1/30], loss:1.8515, CE loss:0.8591 , info NCE loss:7.4748
[2025-01-22 14:05:45,659][INFO] Epoch[1/30], train B-acc: 0.6560(0.5878-0.7135), test B-acc: 0.5448(0.4440-0.6437)
[2025-01-22 14:05:45,659][INFO] Epoch[1/30], train AUC: 0.7496(0.6763-0.8177), test AUC: 0.5635(0.4375-0.6840)
[2025-01-22 14:07:58,404][INFO] Epoch[2/30], loss:1.5659, CE loss:0.5856 , info NCE loss:7.1206
[2025-01-22 14:07:58,404][INFO] Epoch[2/30], train B-acc: 0.5000(0.5000-0.5000), test B-acc: 0.5000(0.5000-0.5000)
[2025-01-22 14:07:58,405][INFO] Epoch[2/30], train AUC: 0.7980(0.7242-0.8681), test AUC: 0.6750(0.5556-0.7831)
[2025-01-22 14:10:08,447][INFO] Epoch[3/30], loss:1.5054, CE loss:0.5519 , info NCE loss:6.9085
[2025-01-22 14:10:08,447][INFO] Epoch[3/30], train B-acc: 0.5560(0.5095-0.6067), test B-acc: 0.5091(0.4819-0.5517)
[2025-01-22 14:10:08,448][INFO] Epoch[3/30], train AUC: 0.8066(0.7343-0.8669), test AUC: 0.6940(0.5637-0.7980)
[2025-01-22 14:12:11,317][INFO] Epoch[4/30], loss:1.4855, CE loss:0.5415 , info NCE loss:6.8352
[2025-01-22 14:12:11,317][INFO] Epoch[4/30], train B-acc: 0.5227(0.5000-0.5606), test B-acc: 0.4938(0.4797-0.5000)
[2025-01-22 14:12:11,317][INFO] Epoch[4/30], train AUC: 0.8206(0.7525-0.8836), test AUC: 0.7169(0.5893-0.8310)
[2025-01-22 14:14:15,151][INFO] Epoch[5/30], loss:1.4733, CE loss:0.5358 , info NCE loss:6.7857
[2025-01-22 14:14:15,152][INFO] Epoch[5/30], train B-acc: 0.5456(0.5082-0.5936), test B-acc: 0.5086(0.4855-0.5556)
[2025-01-22 14:14:15,152][INFO] Epoch[5/30], train AUC: 0.8439(0.7784-0.9026), test AUC: 0.7324(0.6228-0.8379)
[2025-01-22 14:16:19,040][INFO] Epoch[6/30], loss:1.4645, CE loss:0.5313 , info NCE loss:6.7526
[2025-01-22 14:16:19,041][INFO] Epoch[6/30], train B-acc: 0.5694(0.5238-0.6300), test B-acc: 0.5156(0.5000-0.5556)
[2025-01-22 14:16:19,041][INFO] Epoch[6/30], train AUC: 0.8716(0.8134-0.9214), test AUC: 0.7549(0.6416-0.8581)
[2025-01-22 14:18:23,310][INFO] Epoch[7/30], loss:1.4598, CE loss:0.5270 , info NCE loss:6.7456
[2025-01-22 14:18:23,310][INFO] Epoch[7/30], train B-acc: 0.6083(0.5485-0.6785), test B-acc: 0.5161(0.5000-0.5556)
[2025-01-22 14:18:23,310][INFO] Epoch[7/30], train AUC: 0.8906(0.8381-0.9377), test AUC: 0.7633(0.6468-0.8668)
[2025-01-22 14:20:31,000][INFO] Epoch[8/30], loss:1.4544, CE loss:0.5228 , info NCE loss:6.7339
[2025-01-22 14:20:31,000][INFO] Epoch[8/30], train B-acc: 0.6269(0.5655-0.7009), test B-acc: 0.5421(0.4938-0.6040)
[2025-01-22 14:20:31,000][INFO] Epoch[8/30], train AUC: 0.9031(0.8496-0.9424), test AUC: 0.7730(0.6530-0.8716)
[2025-01-22 14:22:36,428][INFO] Epoch[9/30], loss:1.4490, CE loss:0.5185 , info NCE loss:6.7215
[2025-01-22 14:22:36,428][INFO] Epoch[9/30], train B-acc: 0.6711(0.6028-0.7516), test B-acc: 0.5741(0.5132-0.6481)
[2025-01-22 14:22:36,428][INFO] Epoch[9/30], train AUC: 0.9155(0.8695-0.9526), test AUC: 0.7715(0.6648-0.8609)
[2025-01-22 14:24:43,264][INFO] Epoch[10/30], loss:1.4444, CE loss:0.5147 , info NCE loss:6.7127
[2025-01-22 14:24:43,264][INFO] Epoch[10/30], train B-acc: 0.6846(0.6093-0.7656), test B-acc: 0.5893(0.5221-0.6681)
[2025-01-22 14:24:43,264][INFO] Epoch[10/30], train AUC: 0.9263(0.8867-0.9615), test AUC: 0.7740(0.6629-0.8664)
[2025-01-22 14:26:50,180][INFO] Epoch[11/30], loss:1.4396, CE loss:0.5109 , info NCE loss:6.7027
[2025-01-22 14:26:50,180][INFO] Epoch[11/30], train B-acc: 0.7293(0.6518-0.8066), test B-acc: 0.5849(0.5104-0.6670)
[2025-01-22 14:26:50,181][INFO] Epoch[11/30], train AUC: 0.9361(0.8961-0.9665), test AUC: 0.7721(0.6567-0.8578)
[2025-01-22 14:28:57,829][INFO] Epoch[12/30], loss:1.4361, CE loss:0.5074 , info NCE loss:6.6991
[2025-01-22 14:28:57,830][INFO] Epoch[12/30], train B-acc: 0.7589(0.6778-0.8308), test B-acc: 0.5662(0.4850-0.6560)
[2025-01-22 14:28:57,830][INFO] Epoch[12/30], train AUC: 0.9432(0.9090-0.9701), test AUC: 0.7681(0.6609-0.8647)
[2025-01-22 14:31:05,288][INFO] Epoch[13/30], loss:1.4319, CE loss:0.5038 , info NCE loss:6.6913
[2025-01-22 14:31:05,289][INFO] Epoch[13/30], train B-acc: 0.7873(0.7038-0.8616), test B-acc: 0.5639(0.4841-0.6487)
[2025-01-22 14:31:05,289][INFO] Epoch[13/30], train AUC: 0.9520(0.9184-0.9751), test AUC: 0.7644(0.6633-0.8612)
[2025-01-22 14:33:10,754][INFO] Epoch[14/30], loss:1.4282, CE loss:0.5004 , info NCE loss:6.6862
[2025-01-22 14:33:10,754][INFO] Epoch[14/30], train B-acc: 0.8344(0.7599-0.9034), test B-acc: 0.6394(0.5392-0.7293)
[2025-01-22 14:33:10,755][INFO] Epoch[14/30], train AUC: 0.9585(0.9298-0.9801), test AUC: 0.7658(0.6590-0.8573)
[2025-01-22 14:35:14,821][INFO] Epoch[15/30], loss:1.4249, CE loss:0.4976 , info NCE loss:6.6800
[2025-01-22 14:35:14,821][INFO] Epoch[15/30], train B-acc: 0.8671(0.7977-0.9263), test B-acc: 0.6683(0.5754-0.7750)
[2025-01-22 14:35:14,822][INFO] Epoch[15/30], train AUC: 0.9640(0.9362-0.9840), test AUC: 0.7612(0.6484-0.8594)
[2025-01-22 14:37:21,665][INFO] Epoch[16/30], loss:1.4215, CE loss:0.4947 , info NCE loss:6.6733
[2025-01-22 14:37:21,666][INFO] Epoch[16/30], train B-acc: 0.8761(0.8048-0.9325), test B-acc: 0.7030(0.6091-0.7980)
[2025-01-22 14:37:21,666][INFO] Epoch[16/30], train AUC: 0.9664(0.9391-0.9860), test AUC: 0.7586(0.6523-0.8527)
[2025-01-22 14:39:28,781][INFO] Epoch[17/30], loss:1.4183, CE loss:0.4915 , info NCE loss:6.6707
[2025-01-22 14:39:28,781][INFO] Epoch[17/30], train B-acc: 0.8954(0.8294-0.9467), test B-acc: 0.7030(0.6019-0.7998)
[2025-01-22 14:39:28,781][INFO] Epoch[17/30], train AUC: 0.9710(0.9442-0.9886), test AUC: 0.7630(0.6498-0.8546)
[2025-01-22 14:41:36,024][INFO] Epoch[18/30], loss:1.4155, CE loss:0.4894 , info NCE loss:6.6630
[2025-01-22 14:41:36,024][INFO] Epoch[18/30], train B-acc: 0.9191(0.8664-0.9598), test B-acc: 0.7045(0.5994-0.7966)
[2025-01-22 14:41:36,024][INFO] Epoch[18/30], train AUC: 0.9745(0.9520-0.9902), test AUC: 0.7574(0.6475-0.8543)
[2025-01-22 14:43:44,689][INFO] Epoch[19/30], loss:1.4136, CE loss:0.4883 , info NCE loss:6.6570
[2025-01-22 14:43:44,689][INFO] Epoch[19/30], train B-acc: 0.9237(0.8732-0.9623), test B-acc: 0.7083(0.6139-0.8091)
[2025-01-22 14:43:44,689][INFO] Epoch[19/30], train AUC: 0.9780(0.9567-0.9923), test AUC: 0.7560(0.6466-0.8587)
[2025-01-22 14:45:52,377][INFO] Epoch[20/30], loss:1.4105, CE loss:0.4853 , info NCE loss:6.6535
[2025-01-22 14:45:52,378][INFO] Epoch[20/30], train B-acc: 0.9352(0.8873-0.9733), test B-acc: 0.7053(0.6031-0.8048)
[2025-01-22 14:45:52,378][INFO] Epoch[20/30], train AUC: 0.9816(0.9631-0.9943), test AUC: 0.7583(0.6380-0.8529)
[2025-01-22 14:47:59,646][INFO] Epoch[21/30], loss:1.4080, CE loss:0.4835 , info NCE loss:6.6469
[2025-01-22 14:47:59,646][INFO] Epoch[21/30], train B-acc: 0.9198(0.8744-0.9561), test B-acc: 0.6718(0.5564-0.7694)
[2025-01-22 14:47:59,646][INFO] Epoch[21/30], train AUC: 0.9837(0.9659-0.9951), test AUC: 0.7557(0.6320-0.8497)
[2025-01-22 14:50:02,279][INFO] Epoch[22/30], loss:1.4043, CE loss:0.4801 , info NCE loss:6.6412
[2025-01-22 14:50:02,279][INFO] Epoch[22/30], train B-acc: 0.9367(0.8919-0.9688), test B-acc: 0.6836(0.5788-0.7787)
[2025-01-22 14:50:02,279][INFO] Epoch[22/30], train AUC: 0.9864(0.9706-0.9960), test AUC: 0.7502(0.6322-0.8421)
[2025-01-22 14:52:10,296][INFO] Epoch[23/30], loss:1.4013, CE loss:0.4768 , info NCE loss:6.6400
[2025-01-22 14:52:10,297][INFO] Epoch[23/30], train B-acc: 0.9372(0.8954-0.9689), test B-acc: 0.6720(0.5654-0.7673)
[2025-01-22 14:52:10,298][INFO] Epoch[23/30], train AUC: 0.9882(0.9754-0.9969), test AUC: 0.7428(0.6321-0.8457)
[2025-01-22 14:54:22,265][INFO] Epoch[24/30], loss:1.3982, CE loss:0.4741 , info NCE loss:6.6343
[2025-01-22 14:54:22,266][INFO] Epoch[24/30], train B-acc: 0.9321(0.8921-0.9573), test B-acc: 0.6688(0.5603-0.7665)
[2025-01-22 14:54:22,267][INFO] Epoch[24/30], train AUC: 0.9898(0.9767-0.9974), test AUC: 0.7429(0.6305-0.8401)
[2025-01-22 14:56:33,106][INFO] Epoch[25/30], loss:1.3964, CE loss:0.4724 , info NCE loss:6.6327
[2025-01-22 14:56:33,106][INFO] Epoch[25/30], train B-acc: 0.9263(0.9025-0.9493), test B-acc: 0.6832(0.5799-0.7784)
[2025-01-22 14:56:33,106][INFO] Epoch[25/30], train AUC: 0.9910(0.9802-0.9978), test AUC: 0.7422(0.6212-0.8447)
[2025-01-22 14:58:41,615][INFO] Epoch[26/30], loss:1.3952, CE loss:0.4716 , info NCE loss:6.6289
[2025-01-22 14:58:41,615][INFO] Epoch[26/30], train B-acc: 0.8680(0.8401-0.8952), test B-acc: 0.6267(0.5280-0.7127)
[2025-01-22 14:58:41,615][INFO] Epoch[26/30], train AUC: 0.9923(0.9822-0.9981), test AUC: 0.7464(0.6409-0.8367)
[2025-01-22 15:00:46,454][INFO] Epoch[27/30], loss:1.3929, CE loss:0.4696 , info NCE loss:6.6251
[2025-01-22 15:00:46,455][INFO] Epoch[27/30], train B-acc: 0.9502(0.9298-0.9671), test B-acc: 0.6625(0.5598-0.7571)
[2025-01-22 15:00:46,455][INFO] Epoch[27/30], train AUC: 0.9933(0.9849-0.9984), test AUC: 0.7399(0.6283-0.8393)
[2025-01-22 15:02:59,940][INFO] Epoch[28/30], loss:1.3913, CE loss:0.4682 , info NCE loss:6.6220
[2025-01-22 15:02:59,942][INFO] Epoch[28/30], train B-acc: 0.9713(0.9555-0.9848), test B-acc: 0.6860(0.5756-0.7781)
[2025-01-22 15:02:59,942][INFO] Epoch[28/30], train AUC: 0.9939(0.9856-0.9988), test AUC: 0.7412(0.6218-0.8397)
[2025-01-22 15:03:56,185][INFO] Epoch 29 retry 1 of 5, loss did not decrease.
[2025-01-22 15:04:42,577][INFO] Epoch 29 retry 2 of 5, loss did not decrease.
[2025-01-22 15:06:36,599][INFO] Epoch[29/30], loss:1.3871, CE loss:0.4642 , info NCE loss:6.6168
[2025-01-22 15:06:36,600][INFO] Epoch[29/30], train B-acc: 0.9417(0.9191-0.9604), test B-acc: 0.6520(0.5481-0.7424)
[2025-01-22 15:06:36,601][INFO] Epoch[29/30], train AUC: 0.9959(0.9889-0.9993), test AUC: 0.7354(0.6140-0.8332)
[2025-01-22 15:08:41,060][INFO] Epoch[30/30], loss:1.3849, CE loss:0.4624 , info NCE loss:6.6127
[2025-01-22 15:08:41,060][INFO] Epoch[30/30], train B-acc: 0.8550(0.8266-0.8846), test B-acc: 0.6575(0.5663-0.7371)
[2025-01-22 15:08:41,062][INFO] Epoch[30/30], train AUC: 0.9960(0.9896-0.9994), test AUC: 0.7353(0.6163-0.8354)
