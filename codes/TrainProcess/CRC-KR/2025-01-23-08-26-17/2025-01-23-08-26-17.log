[2025-01-23 08:26:17,813][INFO] Running PROJECT: CRC-KR, P LEARNING RATE: 0.001, OPTIMIZER: ADAMW, NUM EPOCHS: 30, BATCH SIZE: 2048, DEVICES: cuda, SMOOTHING: 0.25
[2025-01-23 08:26:17,813][INFO] params["in_chans"]=[200, 16]python run_MIL_model.py --proj CRC-KR --num_epochs 30 --plr 1e-3  --smoothing 0.25
[2025-01-23 08:26:17,814][INFO] params["dims"]=[512, 512] 温度参数为0.65
[2025-01-23 08:26:17,814][INFO] params["out_chans"]=[16, 8]
[2025-01-23 08:26:17,814][INFO] params["heads"]=[8, 4]
[2025-01-23 08:26:17,815][INFO] params["dropout"]=[0.8, 0.4, 0.4]
[2025-01-23 08:28:21,160][INFO] Epoch[1/30], loss:1.0221, CE loss:0.8534 , info NCE loss:0.5591
[2025-01-23 08:28:21,160][INFO] Epoch[1/30], train B-acc: 0.5000(0.5000-0.5000), test B-acc: 0.5000(0.5000-0.5000)
[2025-01-23 08:28:21,161][INFO] Epoch[1/30], train AUC: 0.8004(0.7307-0.8632), test AUC: 0.6886(0.5690-0.7958)
[2025-01-23 08:31:00,343][INFO] Epoch[2/30], loss:0.7200, CE loss:0.5562 , info NCE loss:0.5400
[2025-01-23 08:31:00,343][INFO] Epoch[2/30], train B-acc: 0.5547(0.5126-0.6128), test B-acc: 0.5008(0.4737-0.5455)
[2025-01-23 08:31:00,343][INFO] Epoch[2/30], train AUC: 0.8161(0.7452-0.8787), test AUC: 0.6931(0.5830-0.7926)
[2025-01-23 08:33:38,991][INFO] Epoch[3/30], loss:0.6793, CE loss:0.5224 , info NCE loss:0.5311
[2025-01-23 08:33:38,991][INFO] Epoch[3/30], train B-acc: 0.5217(0.5000-0.5638), test B-acc: 0.5000(0.5000-0.5000)
[2025-01-23 08:33:38,992][INFO] Epoch[3/30], train AUC: 0.8418(0.7727-0.8984), test AUC: 0.7317(0.6121-0.8356)
[2025-01-23 08:35:27,226][INFO] Epoch[4/30], loss:0.6644, CE loss:0.5089 , info NCE loss:0.5247
[2025-01-23 08:35:27,226][INFO] Epoch[4/30], train B-acc: 0.5336(0.4979-0.5789), test B-acc: 0.5000(0.5000-0.5000)
[2025-01-23 08:35:27,226][INFO] Epoch[4/30], train AUC: 0.8632(0.8031-0.9120), test AUC: 0.7478(0.6278-0.8465)
[2025-01-23 08:37:15,350][INFO] Epoch[5/30], loss:0.6566, CE loss:0.5018 , info NCE loss:0.5193
[2025-01-23 08:37:15,350][INFO] Epoch[5/30], train B-acc: 0.5694(0.5216-0.6288), test B-acc: 0.5161(0.5000-0.5556)
[2025-01-23 08:37:15,350][INFO] Epoch[5/30], train AUC: 0.8903(0.8357-0.9404), test AUC: 0.7616(0.6393-0.8660)
[2025-01-23 08:39:02,495][INFO] Epoch[6/30], loss:0.6500, CE loss:0.4956 , info NCE loss:0.5209
[2025-01-23 08:39:02,496][INFO] Epoch[6/30], train B-acc: 0.5938(0.5374-0.6558), test B-acc: 0.5156(0.5000-0.5556)
[2025-01-23 08:39:02,496][INFO] Epoch[6/30], train AUC: 0.9088(0.8630-0.9504), test AUC: 0.7763(0.6656-0.8699)
[2025-01-23 08:40:49,819][INFO] Epoch[7/30], loss:0.6444, CE loss:0.4903 , info NCE loss:0.5204
[2025-01-23 08:40:49,819][INFO] Epoch[7/30], train B-acc: 0.6427(0.5710-0.7100), test B-acc: 0.5652(0.5000-0.6346)
[2025-01-23 08:40:49,821][INFO] Epoch[7/30], train AUC: 0.9218(0.8788-0.9557), test AUC: 0.7894(0.6623-0.8729)
[2025-01-23 08:42:39,128][INFO] Epoch[8/30], loss:0.6384, CE loss:0.4846 , info NCE loss:0.5188
[2025-01-23 08:42:39,128][INFO] Epoch[8/30], train B-acc: 0.6415(0.5748-0.7181), test B-acc: 0.5904(0.5281-0.6731)
[2025-01-23 08:42:39,128][INFO] Epoch[8/30], train AUC: 0.9328(0.8896-0.9648), test AUC: 0.7953(0.6878-0.8808)
[2025-01-23 08:44:28,922][INFO] Epoch[9/30], loss:0.6339, CE loss:0.4803 , info NCE loss:0.5183
[2025-01-23 08:44:28,923][INFO] Epoch[9/30], train B-acc: 0.7334(0.6522-0.8136), test B-acc: 0.5991(0.5183-0.6825)
[2025-01-23 08:44:28,923][INFO] Epoch[9/30], train AUC: 0.9426(0.9073-0.9698), test AUC: 0.7939(0.6858-0.8857)
[2025-01-23 08:46:16,261][INFO] Epoch[10/30], loss:0.6300, CE loss:0.4765 , info NCE loss:0.5187
[2025-01-23 08:46:16,262][INFO] Epoch[10/30], train B-acc: 0.7245(0.6479-0.8024), test B-acc: 0.5948(0.5205-0.6770)
[2025-01-23 08:46:16,262][INFO] Epoch[10/30], train AUC: 0.9538(0.9213-0.9791), test AUC: 0.7991(0.6926-0.8877)
[2025-01-23 08:48:03,597][INFO] Epoch[11/30], loss:0.6246, CE loss:0.4712 , info NCE loss:0.5165
[2025-01-23 08:48:03,598][INFO] Epoch[11/30], train B-acc: 0.8302(0.7522-0.9023), test B-acc: 0.6048(0.5219-0.6929)
[2025-01-23 08:48:03,598][INFO] Epoch[11/30], train AUC: 0.9601(0.9284-0.9817), test AUC: 0.8013(0.6997-0.8876)
[2025-01-23 08:49:49,147][INFO] Epoch[12/30], loss:0.6191, CE loss:0.4659 , info NCE loss:0.5175
[2025-01-23 08:49:49,147][INFO] Epoch[12/30], train B-acc: 0.8433(0.7707-0.9084), test B-acc: 0.6140(0.5223-0.7103)
[2025-01-23 08:49:49,147][INFO] Epoch[12/30], train AUC: 0.9663(0.9397-0.9858), test AUC: 0.7990(0.6897-0.8848)
[2025-01-23 08:51:35,871][INFO] Epoch[13/30], loss:0.6151, CE loss:0.4620 , info NCE loss:0.5176
[2025-01-23 08:51:35,871][INFO] Epoch[13/30], train B-acc: 0.8794(0.8125-0.9390), test B-acc: 0.6456(0.5475-0.7354)
[2025-01-23 08:51:35,871][INFO] Epoch[13/30], train AUC: 0.9724(0.9493-0.9880), test AUC: 0.7965(0.6974-0.8862)
[2025-01-23 08:53:23,756][INFO] Epoch[14/30], loss:0.6111, CE loss:0.4582 , info NCE loss:0.5151
[2025-01-23 08:53:23,756][INFO] Epoch[14/30], train B-acc: 0.9273(0.8708-0.9679), test B-acc: 0.6909(0.5912-0.7899)
[2025-01-23 08:53:23,757][INFO] Epoch[14/30], train AUC: 0.9764(0.9542-0.9902), test AUC: 0.7874(0.6847-0.8759)
[2025-01-23 08:55:10,540][INFO] Epoch[15/30], loss:0.6071, CE loss:0.4542 , info NCE loss:0.5161
[2025-01-23 08:55:10,540][INFO] Epoch[15/30], train B-acc: 0.9349(0.8794-0.9764), test B-acc: 0.6714(0.5743-0.7667)
[2025-01-23 08:55:10,540][INFO] Epoch[15/30], train AUC: 0.9819(0.9638-0.9939), test AUC: 0.7873(0.6873-0.8721)
[2025-01-23 08:56:58,839][INFO] Epoch[16/30], loss:0.6044, CE loss:0.4516 , info NCE loss:0.5165
[2025-01-23 08:56:58,839][INFO] Epoch[16/30], train B-acc: 0.9515(0.9125-0.9799), test B-acc: 0.6938(0.5980-0.7911)
[2025-01-23 08:56:58,840][INFO] Epoch[16/30], train AUC: 0.9855(0.9702-0.9957), test AUC: 0.7785(0.6726-0.8690)
[2025-01-23 08:58:46,159][INFO] Epoch[17/30], loss:0.6007, CE loss:0.4479 , info NCE loss:0.5159
[2025-01-23 08:58:46,160][INFO] Epoch[17/30], train B-acc: 0.9349(0.8955-0.9596), test B-acc: 0.6985(0.5924-0.7970)
[2025-01-23 08:58:46,160][INFO] Epoch[17/30], train AUC: 0.9892(0.9749-0.9972), test AUC: 0.7750(0.6650-0.8646)
[2025-01-23 09:00:33,301][INFO] Epoch[18/30], loss:0.5964, CE loss:0.4437 , info NCE loss:0.5153
[2025-01-23 09:00:33,301][INFO] Epoch[18/30], train B-acc: 0.9350(0.8987-0.9607), test B-acc: 0.7163(0.6126-0.8075)
[2025-01-23 09:00:33,302][INFO] Epoch[18/30], train AUC: 0.9917(0.9794-0.9986), test AUC: 0.7749(0.6704-0.8639)
[2025-01-23 09:02:19,965][INFO] Epoch[19/30], loss:0.5924, CE loss:0.4398 , info NCE loss:0.5159
[2025-01-23 09:02:19,965][INFO] Epoch[19/30], train B-acc: 0.9408(0.9202-0.9615), test B-acc: 0.7129(0.6168-0.8067)
[2025-01-23 09:02:19,966][INFO] Epoch[19/30], train AUC: 0.9929(0.9820-0.9992), test AUC: 0.7683(0.6684-0.8608)
[2025-01-23 09:04:14,603][INFO] Epoch[20/30], loss:0.5890, CE loss:0.4365 , info NCE loss:0.5141
[2025-01-23 09:04:14,603][INFO] Epoch[20/30], train B-acc: 0.9053(0.8788-0.9280), test B-acc: 0.6848(0.5886-0.7668)
[2025-01-23 09:04:14,603][INFO] Epoch[20/30], train AUC: 0.9936(0.9843-0.9993), test AUC: 0.7688(0.6587-0.8610)
[2025-01-23 09:06:36,362][INFO] Epoch[21/30], loss:0.5861, CE loss:0.4336 , info NCE loss:0.5141
[2025-01-23 09:06:36,363][INFO] Epoch[21/30], train B-acc: 0.9052(0.8799-0.9286), test B-acc: 0.7014(0.6160-0.7854)
[2025-01-23 09:06:36,363][INFO] Epoch[21/30], train AUC: 0.9937(0.9846-0.9992), test AUC: 0.7659(0.6567-0.8708)
[2025-01-23 09:08:36,101][INFO] Epoch[22/30], loss:0.5838, CE loss:0.4314 , info NCE loss:0.5144
[2025-01-23 09:08:36,101][INFO] Epoch[22/30], train B-acc: 0.8891(0.8595-0.9142), test B-acc: 0.6778(0.5878-0.7616)
[2025-01-23 09:08:36,101][INFO] Epoch[22/30], train AUC: 0.9945(0.9855-0.9995), test AUC: 0.7605(0.6542-0.8498)
[2025-01-23 09:10:32,981][INFO] Epoch[23/30], loss:0.5804, CE loss:0.4280 , info NCE loss:0.5140
[2025-01-23 09:10:32,982][INFO] Epoch[23/30], train B-acc: 0.9251(0.9017-0.9464), test B-acc: 0.6810(0.5848-0.7688)
[2025-01-23 09:10:32,982][INFO] Epoch[23/30], train AUC: 0.9951(0.9873-0.9995), test AUC: 0.7583(0.6412-0.8568)
[2025-01-23 09:11:18,671][INFO] Epoch 24 retry 1 of 5, loss did not decrease.
[2025-01-23 09:12:04,570][INFO] Epoch 24 retry 2 of 5, loss did not decrease.
[2025-01-23 09:12:49,853][INFO] Epoch 24 retry 3 of 5, loss did not decrease.
[2025-01-23 09:14:45,309][INFO] Epoch[24/30], loss:0.5769, CE loss:0.4244 , info NCE loss:0.5152
[2025-01-23 09:14:45,309][INFO] Epoch[24/30], train B-acc: 0.8870(0.8592-0.9138), test B-acc: 0.6748(0.5833-0.7545)
[2025-01-23 09:14:45,309][INFO] Epoch[24/30], train AUC: 0.9948(0.9869-0.9993), test AUC: 0.7528(0.6427-0.8458)
