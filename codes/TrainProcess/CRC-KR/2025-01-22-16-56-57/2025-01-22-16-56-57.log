[2025-01-22 16:56:57,868][INFO] Running PROJECT: CRC-KR, P LEARNING RATE: 0.001, OPTIMIZER: ADAMW, NUM EPOCHS: 30, BATCH SIZE: 2048, DEVICES: cuda, SMOOTHING: 0.25
[2025-01-22 16:56:57,869][INFO] params["in_chans"]=[200, 16]python run_MIL_model.py --proj CRC-KR  --num_epochs 30  --plr 1e-3  --smoothing 0.25
[2025-01-22 16:56:57,869][INFO] params["dims"]=[512, 512]温度参数为0.6
[2025-01-22 16:56:57,869][INFO] params["out_chans"]=[16, 8]
[2025-01-22 16:56:57,869][INFO] params["heads"]=[8, 4]
[2025-01-22 16:56:57,869][INFO] params["dropout"]=[0.8, 0.4, 0.4]
[2025-01-22 16:59:09,458][INFO] Epoch[1/30], loss:1.9530, CE loss:0.9701 , info NCE loss:7.5232
[2025-01-22 16:59:09,459][INFO] Epoch[1/30], train B-acc: 0.5990(0.5486-0.6441), test B-acc: 0.5639(0.5029-0.6205)
[2025-01-22 16:59:09,460][INFO] Epoch[1/30], train AUC: 0.7316(0.6475-0.8055), test AUC: 0.6288(0.5133-0.7405)
[2025-01-22 17:02:22,770][INFO] Epoch[2/30], loss:1.5923, CE loss:0.6003 , info NCE loss:7.2135
[2025-01-22 17:02:22,771][INFO] Epoch[2/30], train B-acc: 0.5000(0.5000-0.5000), test B-acc: 0.5000(0.5000-0.5000)
[2025-01-22 17:02:22,771][INFO] Epoch[2/30], train AUC: 0.7774(0.6946-0.8519), test AUC: 0.7069(0.5904-0.8062)
[2025-01-22 17:04:53,882][INFO] Epoch[3/30], loss:1.5009, CE loss:0.5318 , info NCE loss:6.9924
[2025-01-22 17:04:53,883][INFO] Epoch[3/30], train B-acc: 0.5849(0.5251-0.6516), test B-acc: 0.5163(0.4803-0.5780)
[2025-01-22 17:04:53,883][INFO] Epoch[3/30], train AUC: 0.8029(0.7216-0.8656), test AUC: 0.7119(0.6008-0.8133)
[2025-01-22 17:07:28,452][INFO] Epoch[4/30], loss:1.4710, CE loss:0.5174 , info NCE loss:6.8748
[2025-01-22 17:07:28,453][INFO] Epoch[4/30], train B-acc: 0.5213(0.4959-0.5595), test B-acc: 0.4938(0.4800-0.5000)
[2025-01-2[2025-01-22 17:10:01,549][INFO] Epoch[5/30], loss:1.4569, CE loss:0.5099 , info NCE loss:6.8234
[2025-01-22 17:10:01,549][INFO] Epoch[5/30], train B-acc: 0.5320(0.5000-0.5793), test B-acc: 0.5000(0.5000-0.5000)
[2025-01-22 17:10:01,549][INFO] Epoch[5/30], train AUC: 0.8556(0.7808-0.9107), test AUC: 0.7552(0.6455-0.8471)
[2025-01-22 17:12:15,103][INFO] Epoch[6/30], loss:1.4469, CE loss:0.5035 , info NCE loss:6.7929
[2025-01-22 17:12:15,103][INFO] Epoch[6/30], train B-acc: 0.5700(0.5223-0.6286), test B-acc: 0.5161(0.5000-0.5577)
[2025-01-22 17:12:15,103][INFO] Epoch[6/30], train AUC: 0.8823(0.8290-0.9317), test AUC: 0.7755(0.6672-0.8726)
[2025-01-22 17:14:25,422][INFO] Epoch[7/30], loss:1.4409, CE loss:0.4989 , info NCE loss:6.7787
[2025-01-22 17:14:25,423][INFO] Epoch[7/30], train B-acc: 0.5930(0.5326-0.6580), test B-acc: 0.5156(0.5000-0.5541)
[2025-01-22 17:14:25,423][INFO] Epoch[7/30], train AUC: 0.8996(0.8518-0.9390), test AUC: 0.7867(0.6792-0.8717)
[2025-01-22 17:16:40,558][INFO] Epoch[8/30], loss:1.4338, CE loss:0.4927 , info NCE loss:6.7665
[2025-01-22 17:16:40,558][INFO] Epoch[8/30], train B-acc: 0.6423(0.5750-0.7105), test B-acc: 0.5420(0.4940-0.6010)
[2025-01-22 17:16:40,558][INFO] Epoch[8/30], train AUC: 0.9148(0.8712-0.9499), test AUC: 0.7966(0.6842-0.8834)
[2025-01-22 17:18:50,852][INFO] Epoch[9/30], loss:1.4278, CE loss:0.4873 , info NCE loss:6.7571
[2025-01-22 17:18:50,852][INFO] Epoch[9/30], train B-acc: 0.6410(0.5772-0.7159), test B-acc: 0.5937(0.5234-0.6774)
[2025-01-22 17:18:50,852][INFO] Epoch[9/30], train AUC: 0.9232(0.8830-0.9532), test AUC: 0.7931(0.6858-0.8832)
[2025-01-22 17:21:02,183][INFO] Epoch[10/30], loss:1.4224, CE loss:0.4829 , info NCE loss:6.7464
[2025-01-22 17:21:02,184][INFO] Epoch[10/30], train B-acc: 0.6981(0.6183-0.7791), test B-acc: 0.5840(0.5207-0.6606)
[2025-01-22 17:21:02,184][INFO] Epoch[10/30], train AUC: 0.9338(0.8964-0.9633), test AUC: 0.7990(0.7066-0.8878)
[2025-01-22 17:23:14,319][INFO] Epoch[11/30], loss:1.4184, CE loss:0.4786 , info NCE loss:6.7440
[2025-01-22 17:23:14,320][INFO] Epoch[11/30], train B-acc: 0.7349(0.6515-0.8160), test B-acc: 0.6017(0.5330-0.6821)
[2025-01-22 17:23:14,320][INFO] Epoch[11/30], train AUC: 0.9437(0.9073-0.9709), test AUC: 0.8014(0.6941-0.8884)
[2025-01-22 17:25:27,392][INFO] Epoch[12/30], loss:1.4139, CE loss:0.4745 , info NCE loss:6.7372
[2025-01-22 17:25:27,392][INFO] Epoch[12/30], train B-acc: 0.7813(0.7031-0.8553), test B-acc: 0.5904(0.5126-0.6772)
[2025-01-22 17:25:27,393][INFO] Epoch[12/30], train AUC: 0.9519(0.9218-0.9768), test AUC: 0.8011(0.7069-0.8865)
[2025-01-22 17:27:36,760][INFO] Epoch[13/30], loss:1.4096, CE loss:0.4700 , info NCE loss:6.7341
[2025-01-22 17:27:36,762][INFO] Epoch[13/30], train B-acc: 0.8260(0.7555-0.8975), test B-acc: 0.6051(0.5051-0.6946)
[2025-01-22 17:27:36,762][INFO] Epoch[13/30], train AUC: 0.9600(0.9330-0.9817), test AUC: 0.8017(0.6946-0.8902)
[2025-01-22 17:29:46,042][INFO] Epoch[14/30], loss:1.4056, CE loss:0.4663 , info NCE loss:6.7285
[2025-01-22 17:29:46,042][INFO] Epoch[14/30], train B-acc: 0.8558(0.7832-0.9190), test B-acc: 0.6382(0.5447-0.7437)
[2025-01-22 17:29:46,042][INFO] Epoch[14/30], train AUC: 0.9658(0.9388-0.9853), test AUC: 0.8017(0.6952-0.8871)
[2025-01-22 17:31:54,728][INFO] Epoch[15/30], loss:1.4015, CE loss:0.4627 , info NCE loss:6.7217
[2025-01-22 17:31:54,728][INFO] Epoch[15/30], train B-acc: 0.8407(0.7684-0.9052), test B-acc: 0.6269(0.5321-0.7211)
[2025-01-22 17:31:54,728][INFO] Epoch[15/30], train AUC: 0.9712(0.9500-0.9873), test AUC: 0.8082(0.7046-0.8899)
[2025-01-22 17:34:04,276][INFO] Epoch[16/30], loss:1.3992, CE loss:0.4607 , info NCE loss:6.7172
[2025-01-22 17:34:04,276][INFO] Epoch[16/30], train B-acc: 0.9015(0.8402-0.9534), test B-acc: 0.6737(0.5826-0.7726)
[2025-01-22 17:34:04,276][INFO] Epoch[16/30], train AUC: 0.9762(0.9572-0.9905), test AUC: 0.8010(0.6997-0.8844)
[2025-01-22 17:36:12,400][INFO] Epoch[17/30], loss:1.3972, CE loss:0.4588 , info NCE loss:6.7150
[2025-01-22 17:36:12,401][INFO] Epoch[17/30], train B-acc: 0.9197(0.8696-0.9558), test B-acc: 0.6878(0.5945-0.7903)
[2025-01-22 17:36:12,401][INFO] Epoch[17/30], train AUC: 0.9799(0.9622-0.9927), test AUC: 0.7916(0.6915-0.8758)
[2025-01-22 17:38:19,637][INFO] Epoch[18/30], loss:1.3918, CE loss:0.4530 , info NCE loss:6.7115
[2025-01-22 17:38:19,637][INFO] Epoch[18/30], train B-acc: 0.9268(0.8754-0.9674), test B-acc: 0.6786(0.5751-0.7764)
[2025-01-22 17:38:19,637][INFO] Epoch[18/30], train AUC: 0.9849(0.9702-0.9951), test AUC: 0.7919(0.6814-0.8814)
[2025-01-22 17:40:27,857][INFO] Epoch[19/30], loss:1.3882, CE loss:0.4494 , info NCE loss:6.7081
[2025-01-22 17:40:27,857][INFO] Epoch[19/30], train B-acc: 0.9392(0.8969-0.9692), test B-acc: 0.6696(0.5709-0.7707)
[2025-01-22 17:40:27,857][INFO] Epoch[19/30], train AUC: 0.9865(0.9724-0.9960), test AUC: 0.7883(0.6842-0.8706)
[2025-01-22 17:42:35,531][INFO] Epoch[20/30], loss:1.3853, CE loss:0.4470 , info NCE loss:6.7021
[2025-01-22 17:42:35,531][INFO] Epoch[20/30], train B-acc: 0.9361(0.8954-0.9685), test B-acc: 0.6554(0.5522-0.7527)
[2025-01-22 17:42:35,531][INFO] Epoch[20/30], train AUC: 0.9874(0.9738-0.9957), test AUC: 0.7808(0.6847-0.8686)
[2025-01-22 17:44:43,206][INFO] Epoch[21/30], loss:1.3820, CE loss:0.4440 , info NCE loss:6.6973
[2025-01-22 17:44:43,207][INFO] Epoch[21/30], train B-acc: 0.9367(0.9156-0.9559), test B-acc: 0.7072(0.6084-0.8024)
[2025-01-22 17:44:43,207][INFO] Epoch[21/30], train AUC: 0.9900(0.9796-0.9970), test AUC: 0.7748(0.6738-0.8620)
[2025-01-22 17:46:56,742][INFO] Epoch[22/30], loss:1.3810, CE loss:0.4437 , info NCE loss:6.6926
[2025-01-22 17:46:56,744][INFO] Epoch[22/30], train B-acc: 0.9115(0.8856-0.9350), test B-acc: 0.7078(0.6071-0.7916)
[2025-01-22 17:46:56,744][INFO] Epoch[22/30], train AUC: 0.9907(0.9811-0.9979), test AUC: 0.7718(0.6659-0.8561)
[2025-01-22 17:49:07,913][INFO] Epoch[23/30], loss:1.3769, CE loss:0.4396 , info NCE loss:6.6883
[2025-01-22 17:49:07,914][INFO] Epoch[23/30], train B-acc: 0.9055(0.8808-0.9286), test B-acc: 0.7028(0.6131-0.7865)
[2025-01-22 17:49:07,914][INFO] Epoch[23/30], train AUC: 0.9908(0.9802-0.9976), test AUC: 0.7663(0.6587-0.8570)
[2025-01-22 17:51:16,823][INFO] Epoch[24/30], loss:1.3753, CE loss:0.4388 , info NCE loss:6.6824
[2025-01-22 17:51:16,823][INFO] Epoch[24/30], train B-acc: 0.9494(0.9301-0.9679), test B-acc: 0.6983(0.5978-0.7856)
[2025-01-22 17:51:16,823][INFO] Epoch[24/30], train AUC: 0.9916(0.9811-0.9981), test AUC: 0.7614(0.6664-0.8506)
[2025-01-22 17:53:25,528][INFO] Epoch[25/30], loss:1.3736, CE loss:0.4373 , info NCE loss:6.6792
[2025-01-22 17:53:25,528][INFO] Epoch[25/30], train B-acc: 0.9417(0.9208-0.9609), test B-acc: 0.7012(0.5971-0.8026)
[2025-01-22 17:53:25,528][INFO] Epoch[25/30], train AUC: 0.9918(0.9825-0.9983), test AUC: 0.7633(0.6538-0.8517)
[2025-01-22 17:55:40,706][INFO] Epoch[26/30], loss:1.3678, CE loss:0.4309 , info NCE loss:6.6764
[2025-01-22 17:55:40,706][INFO] Epoch[26/30], train B-acc: 0.8817(0.8556-0.9061), test B-acc: 0.6921(0.6019-0.7701)
[2025-01-22 17:55:40,706][INFO] Epoch[26/30], train AUC: 0.9917(0.9819-0.9983), test AUC: 0.7536(0.6483-0.8436)
[2025-01-22 17:57:50,648][INFO] Epoch[27/30], loss:1.3663, CE loss:0.4296 , info NCE loss:6.6745
[2025-01-22 17:57:50,648][INFO] Epoch[27/30], train B-acc: 0.9177(0.8938-0.9414), test B-acc: 0.6737(0.5722-0.7662)
[2025-01-22 17:57:50,648][INFO] Epoch[27/30], train AUC: 0.9915(0.9813-0.9983), test AUC: 0.7496(0.6372-0.8437)
[2025-01-22 18:00:00,608][INFO] Epoch[28/30], loss:1.3633, CE loss:0.4271 , info NCE loss:6.6685
[2025-01-22 18:00:00,608][INFO] Epoch[28/30], train B-acc: 0.9116(0.8891-0.9362), test B-acc: 0.6761(0.5760-0.7663)
[2025-01-22 18:00:00,608][INFO] Epoch[28/30], train AUC: 0.9928(0.9834-0.9985), test AUC: 0.7462(0.6448-0.8386)
[2025-01-22 18:02:16,290][INFO] Epoch[29/30], loss:1.3619, CE loss:0.4260 , info NCE loss:6.6650
[2025-01-22 18:02:16,290][INFO] Epoch[29/30], train B-acc: 0.8681(0.8362-0.8968), test B-acc: 0.6814(0.5922-0.7617)
[2025-01-22 18:02:16,290][INFO] Epoch[29/30], train AUC: 0.9932(0.9842-0.9984), test AUC: 0.7405(0.6258-0.8434)
[2025-01-22 18:04:21,564][INFO] Epoch[30/30], loss:1.3590, CE loss:0.4235 , info NCE loss:6.6599
[2025-01-22 18:04:21,564][INFO] Epoch[30/30], train B-acc: 0.8962(0.8685-0.9198), test B-acc: 0.6637(0.5752-0.7489)
[2025-01-22 18:04:21,564][INFO] Epoch[30/30], train AUC: 0.9935(0.9850-0.9986), test AUC: 0.7328(0.6274-0.8284)
