[2025-01-22 15:11:17,817][INFO] Running PROJECT: CRC-KR, P LEARNING RATE: 0.001, OPTIMIZER: ADAMW, NUM EPOCHS: 30, BATCH SIZE: 2048, DEVICES: cuda, SMOOTHING: 0.2
[2025-01-22 15:11:17,817][INFO] params["in_chans"]=[200, 16]python run_MIL_model.py --proj CRC-KR  --num_epochs 30  --plr 1e-3  --smoothing 0.2
[2025-01-22 15:11:17,818][INFO] params["dims"]=[512, 512]温度参数为0.55
[2025-01-22 15:11:17,818][INFO] params["out_chans"]=[16, 8]
[2025-01-22 15:11:17,818][INFO] params["heads"]=[8, 4]
[2025-01-22 15:11:17,819][INFO] params["dropout"]=[0.8, 0.4, 0.4]
[2025-01-22 15:13:13,813][INFO] Epoch[1/30], loss:1.8950, CE loss:0.8996 , info NCE loss:7.5358
[2025-01-22 15:13:13,813][INFO] Epoch[1/30], train B-acc: 0.6344(0.5765-0.6863), test B-acc: 0.5537(0.4567-0.6386)
[2025-01-22 15:13:13,813][INFO] Epoch[1/30], train AUC: 0.7427(0.6652-0.8189), test AUC: 0.5990(0.4764-0.7129)
[2025-01-22 15:15:14,230][INFO] Epoch[2/30], loss:1.5653, CE loss:0.5612 , info NCE loss:7.2552
[2025-01-22 15:15:14,230][INFO] Epoch[2/30], train B-acc: 0.5000(0.5000-0.5000), test B-acc: 0.5000(0.5000-0.5000)
[2025-01-22 15:15:14,231][INFO] Epoch[2/30], train AUC: 0.7894(0.7041-0.8533), test AUC: 0.6833(0.5692-0.7868)
[2025-01-22 15:17:13,468][INFO] Epoch[3/30], loss:1.4733, CE loss:0.5008 , info NCE loss:6.9839
[2025-01-22 15:17:13,468][INFO] Epoch[3/30], train B-acc: 0.5812(0.5281-0.6421), test B-acc: 0.5248(0.4878-0.5831)
[2025-01-22 15:17:13,468][INFO] Epoch[3/30], train AUC: 0.8092(0.7367-0.8741), test AUC: 0.7068(0.5931-0.8169)
[2025-01-22 15:19:13,930][INFO] Epoch[4/30], loss:1.4472, CE loss:0.4875 , info NCE loss:6.8854
[2025-01-22 15:19:13,931][INFO] Epoch[4/30], train B-acc: 0.5179(0.4936-0.5568), test B-acc: 0.4938(0.4803-0.5000)
[2025-01-22 15:19:13,931][INFO] Epoch[4/30], train AUC: 0.8342(0.7667-0.8883), test AUC: 0.7390(0.6276-0.8415)
[2025-01-22 15:21:14,915][INFO] Epoch[5/30], loss:1.4351, CE loss:0.4795 , info NCE loss:6.8499
[2025-01-22 15:21:14,916][INFO] Epoch[5/30], train B-acc: 0.5676(0.5173-0.6283), test B-acc: 0.5091(0.4863-0.5517)
[2025-01-22 15:21:14,916][INFO] Epoch[5/30], train AUC: 0.8569(0.7941-0.9087), test AUC: 0.7451(0.6294-0.8438)
[2025-01-22 15:23:11,591][INFO] Epoch[6/30], loss:1.4246, CE loss:0.4730 , info NCE loss:6.8172
[2025-01-22 15:23:11,591][INFO] Epoch[6/30], train B-acc: 0.5921(0.5385-0.6624), test B-acc: 0.5264(0.4885-0.5794)
[2025-01-22 15:23:11,591][INFO] Epoch[6/30], train AUC: 0.8817(0.8278-0.9282), test AUC: 0.7573(0.6417-0.8630)
[2025-01-22 15:25:12,571][INFO] Epoch[7/30], loss:1.4137, CE loss:0.4663 , info NCE loss:6.7822
[2025-01-22 15:25:12,571][INFO] Epoch[7/30], train B-acc: 0.6087(0.5500-0.6736), test B-acc: 0.5081(0.4810-0.5474)
[2025-01-22 15:25:12,571][INFO] Epoch[7/30], train AUC: 0.8997(0.8486-0.9392), test AUC: 0.7738(0.6625-0.8681)
[2025-01-22 15:27:12,418][INFO] Epoch[8/30], loss:1.4037, CE loss:0.4606 , info NCE loss:6.7483
[2025-01-22 15:27:12,418][INFO] Epoch[8/30], train B-acc: 0.6303(0.5653-0.7042), test B-acc: 0.5581(0.5020-0.6250)
[2025-01-22 15:27:12,419][INFO] Epoch[8/30], train AUC: 0.9137(0.8732-0.9509), test AUC: 0.7852(0.6782-0.8729)
[2025-01-22 15:29:10,280][INFO] Epoch[9/30], loss:1.3946, CE loss:0.4542 , info NCE loss:6.7233
[2025-01-22 15:29:10,281][INFO] Epoch[9/30], train B-acc: 0.6423(0.5708-0.7104), test B-acc: 0.5742(0.5147-0.6452)
[2025-01-22 15:29:10,281][INFO] Epoch[9/30], train AUC: 0.9268(0.8829-0.9603), test AUC: 0.7886(0.6819-0.8869)
[2025-01-22 15:31:08,757][INFO] Epoch[10/30], loss:1.3877, CE loss:0.4486 , info NCE loss:6.7090
[2025-01-22 15:31:08,757][INFO] Epoch[10/30], train B-acc: 0.6407(0.5769-0.7136), test B-acc: 0.6045(0.5325-0.6833)
[2025-01-22 15:31:08,757][INFO] Epoch[10/30], train AUC: 0.9407(0.9025-0.9661), test AUC: 0.7901(0.6876-0.8836)
[2025-01-22 15:33:03,153][INFO] Epoch[11/30], loss:1.3806, CE loss:0.4432 , info NCE loss:6.6925
[2025-01-22 15:33:03,154][INFO] Epoch[11/30], train B-acc: 0.7331(0.6562-0.8112), test B-acc: 0.5886(0.5126-0.6707)
[2025-01-22 15:33:03,154][INFO] Epoch[11/30], train AUC: 0.9474(0.9127-0.9731), test AUC: 0.7873(0.6851-0.8726)
[2025-01-22 15:34:57,723][INFO] Epoch[12/30], loss:1.3758, CE loss:0.4382 , info NCE loss:6.6886
[2025-01-22 15:34:57,724][INFO] Epoch[12/30], train B-acc: 0.7445(0.6733-0.8215), test B-acc: 0.5806(0.5060-0.6641)
[2025-01-22 15:34:57,724][INFO] Epoch[12/30], train AUC: 0.9565(0.9279-0.9781), test AUC: 0.7811(0.6675-0.8699)
[2025-01-22 15:36:51,999][INFO] Epoch[13/30], loss:1.3720, CE loss:0.4338 , info NCE loss:6.6884
[2025-01-22 15:36:52,000][INFO] Epoch[13/30], train B-acc: 0.8181(0.7374-0.8889), test B-acc: 0.5815(0.5008-0.6775)
[2025-01-22 15:36:52,000][INFO] Epoch[13/30], train AUC: 0.9614(0.9326-0.9818), test AUC: 0.7796(0.6762-0.8777)
[2025-01-22 15:38:46,362][INFO] Epoch[14/30], loss:1.3678, CE loss:0.4292 , info NCE loss:6.6863
[2025-01-22 15:38:46,363][INFO] Epoch[14/30], train B-acc: 0.8328(0.7556-0.9014), test B-acc: 0.6120(0.5304-0.7066)
[2025-01-22 15:38:46,363][INFO] Epoch[14/30], train AUC: 0.9669(0.9420-0.9849), test AUC: 0.7886(0.6918-0.8649)
[2025-01-22 15:40:40,417][INFO] Epoch[15/30], loss:1.3626, CE loss:0.4249 , info NCE loss:6.6763
[2025-01-22 15:40:40,417][INFO] Epoch[15/30], train B-acc: 0.8447(0.7675-0.9104), test B-acc: 0.6282(0.5386-0.7224)
[2025-01-22 15:40:40,417][INFO] Epoch[15/30], train AUC: 0.9725(0.9502-0.9898), test AUC: 0.7822(0.6820-0.8699)
[2025-01-22 15:42:34,179][INFO] Epoch[16/30], loss:1.3590, CE loss:0.4216 , info NCE loss:6.6705
[2025-01-22 15:42:34,180][INFO] Epoch[16/30], train B-acc: 0.8428(0.7728-0.9090), test B-acc: 0.6533(0.5578-0.7470)
[2025-01-22 15:42:34,180][INFO] Epoch[16/30], train AUC: 0.9752(0.9559-0.9898), test AUC: 0.7819(0.6726-0.8707)
[2025-01-22 15:44:29,184][INFO] Epoch[17/30], loss:1.3544, CE loss:0.4172 , info NCE loss:6.6649
[2025-01-22 15:44:29,184][INFO] Epoch[17/30], train B-acc: 0.9116(0.8478-0.9619), test B-acc: 0.6712(0.5708-0.7700)
[2025-01-22 15:44:29,184][INFO] Epoch[17/30], train AUC: 0.9807(0.9630-0.9918), test AUC: 0.7759(0.6685-0.8632)
[2025-01-22 15:46:23,226][INFO] Epoch[18/30], loss:1.3504, CE loss:0.4131 , info NCE loss:6.6618
[2025-01-22 15:46:23,226][INFO] Epoch[18/30], train B-acc: 0.9366(0.8910-0.9731), test B-acc: 0.6553(0.5623-0.7569)
[2025-01-22 15:46:23,226][INFO] Epoch[18/30], train AUC: 0.9831(0.9658-0.9942), test AUC: 0.7718(0.6738-0.8586)
[2025-01-22 15:48:18,254][INFO] Epoch[19/30], loss:1.3472, CE loss:0.4097 , info NCE loss:6.6593
[2025-01-22 15:48:18,255][INFO] Epoch[19/30], train B-acc: 0.9328(0.8823-0.9749), test B-acc: 0.6672(0.5745-0.7660)
[2025-01-22 15:48:18,255][INFO] Epoch[19/30], train AUC: 0.9870(0.9741-0.9961), test AUC: 0.7664(0.6667-0.8544)
[2025-01-22 15:50:12,665][INFO] Epoch[20/30], loss:1.3428, CE loss:0.4053 , info NCE loss:6.6551
[2025-01-22 15:50:12,665][INFO] Epoch[20/30], train B-acc: 0.9381(0.8930-0.9757), test B-acc: 0.6641(0.5654-0.7618)
[2025-01-22 15:50:12,666][INFO] Epoch[20/30], train AUC: 0.9897(0.9785-0.9968), test AUC: 0.7726(0.6640-0.8722)
[2025-01-22 15:52:07,289][INFO] Epoch[21/30], loss:1.3401, CE loss:0.4024 , info NCE loss:6.6537
[2025-01-22 15:52:07,291][INFO] Epoch[21/30], train B-acc: 0.9481(0.9078-0.9798), test B-acc: 0.6777(0.5782-0.7713)
[2025-01-22 15:52:07,291][INFO] Epoch[21/30], train AUC: 0.9925(0.9825-0.9982), test AUC: 0.7702(0.6600-0.8595)
[2025-01-22 15:54:04,074][INFO] Epoch[22/30], loss:1.3360, CE loss:0.3983 , info NCE loss:6.6498
[2025-01-22 15:54:04,075][INFO] Epoch[22/30], train B-acc: 0.9481(0.9132-0.9725), test B-acc: 0.6744(0.5699-0.7781)
[2025-01-22 15:54:04,086][INFO] Epoch[22/30], train AUC: 0.9934(0.9848-0.9985), test AUC: 0.7641(0.6583-0.8599)
[2025-01-22 15:56:03,905][INFO] Epoch[23/30], loss:1.3328, CE loss:0.3951 , info NCE loss:6.6463
[2025-01-22 15:56:03,906][INFO] Epoch[23/30], train B-acc: 0.9622(0.9454-0.9774), test B-acc: 0.6788(0.5733-0.7762)
[2025-01-22 15:56:03,906][INFO] Epoch[23/30], train AUC: 0.9946(0.9874-0.9988), test AUC: 0.7629(0.6526-0.8528)
[2025-01-22 15:58:08,474][INFO] Epoch[24/30], loss:1.3318, CE loss:0.3945 , info NCE loss:6.6429
[2025-01-22 15:58:08,474][INFO] Epoch[24/30], train B-acc: 0.9639(0.9314-0.9846), test B-acc: 0.6614(0.5565-0.7535)
[2025-01-22 15:58:08,474][INFO] Epoch[24/30], train AUC: 0.9949(0.9880-0.9989), test AUC: 0.7596(0.6471-0.8494)
[2025-01-22 15:59:11,281][INFO] Epoch 25 retry 1 of 5, loss did not decrease.
[2025-01-22 16:00:01,705][INFO] Epoch 25 retry 2 of 5, loss did not decrease.
[2025-01-22 16:02:09,368][INFO] Epoch[25/30], loss:1.3305, CE loss:0.3932 , info NCE loss:6.6420
[2025-01-22 16:02:09,369][INFO] Epoch[25/30], train B-acc: 0.9751(0.9607-0.9876), test B-acc: 0.6829(0.5798-0.7808)
[2025-01-22 16:02:09,369][INFO] Epoch[25/30], train AUC: 0.9959(0.9895-0.9992), test AUC: 0.7493(0.6348-0.8431)
[2025-01-22 16:04:16,019][INFO] Epoch[26/30], loss:1.3212, CE loss:0.3830 , info NCE loss:6.6378
[2025-01-22 16:04:16,020][INFO] Epoch[26/30], train B-acc: 0.9582(0.9392-0.9745), test B-acc: 0.7041(0.6054-0.7997)
[2025-01-22 16:04:16,020][INFO] Epoch[26/30], train AUC: 0.9957(0.9889-0.9992), test AUC: 0.7526(0.6450-0.8555)
[2025-01-22 16:06:23,415][INFO] Epoch[27/30], loss:1.3196, CE loss:0.3818 , info NCE loss:6.6340
[2025-01-22 16:06:23,416][INFO] Epoch[27/30], train B-acc: 0.9607(0.9433-0.9766), test B-acc: 0.7007(0.5971-0.8011)
[2025-01-22 16:06:23,416][INFO] Epoch[27/30], train AUC: 0.9963(0.9905-0.9994), test AUC: 0.7459(0.6355-0.8528)
[2025-01-22 16:08:25,417][INFO] Epoch[28/30], loss:1.3172, CE loss:0.3786 , info NCE loss:6.6356
[2025-01-22 16:08:25,417][INFO] Epoch[28/30], train B-acc: 0.9603(0.9409-0.9763), test B-acc: 0.6898(0.5877-0.7845)
[2025-01-22 16:08:25,417][INFO] Epoch[28/30], train AUC: 0.9959(0.9897-0.9991), test AUC: 0.7520(0.6496-0.8443)
[2025-01-22 16:09:18,216][INFO] Epoch 29 retry 1 of 5, loss did not decrease.
[2025-01-22 16:10:09,652][INFO] Epoch 29 retry 2 of 5, loss did not decrease.
[2025-01-22 16:11:00,351][INFO] Epoch 29 retry 3 of 5, loss did not decrease.
[2025-01-22 16:11:50,927][INFO] Epoch 29 retry 4 of 5, loss did not decrease.
[2025-01-22 16:12:40,504][INFO] Epoch 29 retry 5 of 5, loss did not decrease.
[2025-01-22 16:12:40,504][WARNING] Epoch 29 failed to decrease loss after 5 retries.
[2025-01-22 16:13:56,896][INFO] Epoch[29/30], loss:1.3335, CE loss:0.3987 , info NCE loss:6.6311
[2025-01-22 16:13:56,896][INFO] Epoch[29/30], train B-acc: 0.9729(0.9561-0.9857), test B-acc: 0.6920(0.5901-0.7841)
[2025-01-22 16:13:56,896][INFO] Epoch[29/30], train AUC: 0.9973(0.9922-0.9998), test AUC: 0.7475(0.6308-0.8362)
[2025-01-22 16:16:04,448][INFO] Epoch[30/30], loss:1.3134, CE loss:0.3754 , info NCE loss:6.6283
[2025-01-22 16:16:04,449][INFO] Epoch[30/30], train B-acc: 0.9533(0.9342-0.9710), test B-acc: 0.6823(0.5813-0.7781)
[2025-01-22 16:16:04,449][INFO] Epoch[30/30], train AUC: 0.9971(0.9914-0.9999), test AUC: 0.7390(0.6307-0.8371)
