[2025-02-07 12:17:38,822][INFO] Running PROJECT: CRC-KR, P LEARNING RATE: 0.0001, OPTIMIZER: ADAMW, NUM EPOCHS: 40, BATCH SIZE: 2048, DEVICES: cuda, SMOOTHING: 0.5
[2025-02-07 12:17:38,823][INFO] params["in_chans"]=[200, 16]python run_MIL_model.py --proj CRC-KR --num_epochs 40 --plr 1e-4  --smoothing 0.5
[2025-02-07 12:17:38,823][INFO] params["dims"]=[512, 512]
[2025-02-07 12:17:38,823][INFO] params["out_chans"]=[16, 8]
[2025-02-07 12:17:38,823][INFO] params["heads"]=[8, 4]
[2025-02-07 12:17:38,823][INFO] params["dropout"]=[0.8, 0.4, 0.4]
[2025-02-07 12:21:10,249][INFO] Epoch[1/40], loss:0.7168, CE loss:0.6417 , info NCE loss:0.5493
[2025-02-07 12:21:10,249][INFO] Epoch[1/40], train B-acc: 0.5000(0.5000-0.5000), test B-acc: 0.5000(0.5000-0.5000)
[2025-02-07 12:21:10,249][INFO] Epoch[1/40], train AUC: 0.6496(0.5640-0.7322), test AUC: 0.5772(0.4636-0.6816)
[2025-02-07 12:23:38,451][INFO] Epoch[2/40], loss:0.7021, CE loss:0.6273 , info NCE loss:0.5464
[2025-02-07 12:23:38,452][INFO] Epoch[2/40], train B-acc: 0.5000(0.5000-0.5000), test B-acc: 0.5000(0.5000-0.5000)
[2025-02-07 12:23:38,452][INFO] Epoch[2/40], train AUC: 0.7585(0.6745-0.8338), test AUC: 0.6523(0.5339-0.7552)
[2025-02-07 12:26:03,327][INFO] Epoch[3/40], loss:0.6967, CE loss:0.6224 , info NCE loss:0.5391
[2025-02-07 12:26:03,328][INFO] Epoch[3/40], train B-acc: 0.5000(0.5000-0.5000), test B-acc: 0.4938(0.4797-0.5000)
[2025-02-07 12:26:03,328][INFO] Epoch[3/40], train AUC: 0.8051(0.7257-0.8707), test AUC: 0.6926(0.5873-0.7952)
[2025-02-07 12:28:28,245][INFO] Epoch[4/40], loss:0.6923, CE loss:0.6194 , info NCE loss:0.5249
[2025-02-07 12:28:28,245][INFO] Epoch[4/40], train B-acc: 0.5116(0.5000-0.5385), test B-acc: 0.4938(0.4797-0.5000)
[2025-02-07 12:28:28,245][INFO] Epoch[4/40], train AUC: 0.8270(0.7545-0.8931), test AUC: 0.7173(0.6123-0.8117)
[2025-02-07 12:30:45,346][INFO] Epoch[5/40], loss:0.6882, CE loss:0.6174 , info NCE loss:0.5092
[2025-02-07 12:30:45,347][INFO] Epoch[5/40], train B-acc: 0.5208(0.4958-0.5637), test B-acc: 0.4938(0.4797-0.5000)
[2025-02-07 12:30:45,347][INFO] Epoch[5/40], train AUC: 0.8480(0.7736-0.9077), test AUC: 0.7319(0.6230-0.8339)
[2025-02-07 12:33:01,180][INFO] Epoch[6/40], loss:0.6850, CE loss:0.6155 , info NCE loss:0.5030
[2025-02-07 12:33:01,180][INFO] Epoch[6/40], train B-acc: 0.5333(0.4980-0.5773), test B-acc: 0.4938(0.4805-0.5000)
[2025-02-07 12:33:01,181][INFO] Epoch[6/40], train AUC: 0.8617(0.7951-0.9137), test AUC: 0.7392(0.6195-0.8397)
[2025-02-07 12:35:12,646][INFO] Epoch[7/40], loss:0.6827, CE loss:0.6137 , info NCE loss:0.5019
[2025-02-07 12:35:12,646][INFO] Epoch[7/40], train B-acc: 0.5324(0.4980-0.5778), test B-acc: 0.4938(0.4797-0.5000)
[2025-02-07 12:35:12,647][INFO] Epoch[7/40], train AUC: 0.8787(0.8123-0.9287), test AUC: 0.7504(0.6377-0.8473)
[2025-02-07 12:37:24,328][INFO] Epoch[8/40], loss:0.6810, CE loss:0.6122 , info NCE loss:0.4996
[2025-02-07 12:37:24,329][INFO] Epoch[8/40], train B-acc: 0.5700(0.5201-0.6304), test B-acc: 0.5094(0.4857-0.5517)
[2025-02-07 12:37:24,329][INFO] Epoch[8/40], train AUC: 0.8906(0.8354-0.9368), test AUC: 0.7552(0.6394-0.8481)
[2025-02-07 12:39:40,251][INFO] Epoch[9/40], loss:0.6791, CE loss:0.6106 , info NCE loss:0.4978
[2025-02-07 12:39:40,252][INFO] Epoch[9/40], train B-acc: 0.5569(0.5132-0.6186), test B-acc: 0.5000(0.5000-0.5000)
[2025-02-07 12:39:40,252][INFO] Epoch[9/40], train AUC: 0.9016(0.8502-0.9429), test AUC: 0.7683(0.6652-0.8636)
[2025-02-07 12:41:51,662][INFO] Epoch[10/40], loss:0.6776, CE loss:0.6092 , info NCE loss:0.4957
[2025-02-07 12:41:51,662][INFO] Epoch[10/40], train B-acc: 0.5694(0.5167-0.6274), test B-acc: 0.5323(0.5000-0.5857)
[2025-02-07 12:41:51,662][INFO] Epoch[10/40], train AUC: 0.9091(0.8577-0.9484), test AUC: 0.7695(0.6642-0.8614)
[2025-02-07 12:44:00,668][INFO] Epoch[11/40], loss:0.6762, CE loss:0.6080 , info NCE loss:0.4962
[2025-02-07 12:44:00,668][INFO] Epoch[11/40], train B-acc: 0.5900(0.5336-0.6543), test B-acc: 0.5484(0.5000-0.6111)
[2025-02-07 12:44:00,669][INFO] Epoch[11/40], train AUC: 0.9148(0.8692-0.9511), test AUC: 0.7800(0.6697-0.8629)
[2025-02-07 12:46:13,499][INFO] Epoch[12/40], loss:0.6747, CE loss:0.6066 , info NCE loss:0.4952
[2025-02-07 12:46:13,509][INFO] Epoch[12/40], train B-acc: 0.5946(0.5318-0.6577), test B-acc: 0.5469(0.5000-0.6071)
[2025-02-07 12:46:13,509][INFO] Epoch[12/40], train AUC: 0.9238(0.8797-0.9585), test AUC: 0.7815(0.6808-0.8740)
[2025-02-07 12:48:26,404][INFO] Epoch[13/40], loss:0.6736, CE loss:0.6057 , info NCE loss:0.4921
[2025-02-07 12:48:26,404][INFO] Epoch[13/40], train B-acc: 0.6407(0.5748-0.7063), test B-acc: 0.5742(0.5157-0.6485)
[2025-02-07 12:48:26,404][INFO] Epoch[13/40], train AUC: 0.9291(0.8880-0.9619), test AUC: 0.7820(0.6827-0.8710)
[2025-02-07 12:50:39,280][INFO] Epoch[14/40], loss:0.6724, CE loss:0.6046 , info NCE loss:0.4928
[2025-02-07 12:50:39,280][INFO] Epoch[14/40], train B-acc: 0.6380(0.5766-0.7088), test B-acc: 0.5775(0.5126-0.6481)
[2025-02-07 12:50:39,281][INFO] Epoch[14/40], train AUC: 0.9363(0.8962-0.9654), test AUC: 0.7911(0.6842-0.8737)
[2025-02-07 12:52:56,136][INFO] Epoch[15/40], loss:0.6714, CE loss:0.6036 , info NCE loss:0.4896
[2025-02-07 12:52:56,136][INFO] Epoch[15/40], train B-acc: 0.6331(0.5614-0.6979), test B-acc: 0.5742(0.5140-0.6551)
[2025-02-07 12:52:56,136][INFO] Epoch[15/40], train AUC: 0.9425(0.9038-0.9697), test AUC: 0.7926(0.6931-0.8842)
[2025-02-07 12:55:14,754][INFO] Epoch[16/40], loss:0.6709, CE loss:0.6032 , info NCE loss:0.4932
[2025-02-07 12:55:14,755][INFO] Epoch[16/40], train B-acc: 0.7001(0.6261-0.7772), test B-acc: 0.6029(0.5289-0.6834)
[2025-02-07 12:55:14,755][INFO] Epoch[16/40], train AUC: 0.9450(0.9092-0.9712), test AUC: 0.7913(0.6933-0.8767)
[2025-02-07 12:57:27,239][INFO] Epoch[17/40], loss:0.6700, CE loss:0.6024 , info NCE loss:0.4893
[2025-02-07 12:57:27,239][INFO] Epoch[17/40], train B-acc: 0.6783(0.6020-0.7479), test B-acc: 0.5865(0.5143-0.6730)
[2025-02-07 12:57:27,239][INFO] Epoch[17/40], train AUC: 0.9461(0.9076-0.9741), test AUC: 0.7887(0.6816-0.8729)
[2025-02-07 12:59:41,332][INFO] Epoch[18/40], loss:0.6688, CE loss:0.6012 , info NCE loss:0.4911
[2025-02-07 12:59:41,333][INFO] Epoch[18/40], train B-acc: 0.7041(0.6253-0.7791), test B-acc: 0.5851(0.5191-0.6667)
[2025-02-07 12:59:41,333][INFO] Epoch[18/40], train AUC: 0.9510(0.9163-0.9741), test AUC: 0.7919(0.6977-0.8730)
[2025-02-07 13:01:56,153][INFO] Epoch[19/40], loss:0.6681, CE loss:0.6005 , info NCE loss:0.4903
[2025-02-07 13:01:56,153][INFO] Epoch[19/40], train B-acc: 0.7500(0.6702-0.8250), test B-acc: 0.5894(0.5086-0.6790)
[2025-02-07 13:01:56,154][INFO] Epoch[19/40], train AUC: 0.9525(0.9233-0.9765), test AUC: 0.7920(0.6935-0.8743)
[2025-02-07 13:04:07,673][INFO] Epoch[20/40], loss:0.6674, CE loss:0.5999 , info NCE loss:0.4894
[2025-02-07 13:04:07,673][INFO] Epoch[20/40], train B-acc: 0.7153(0.6407-0.7892), test B-acc: 0.5818(0.5110-0.6615)
[2025-02-07 13:04:07,674][INFO] Epoch[20/40], train AUC: 0.9553(0.9255-0.9806), test AUC: 0.7954(0.6987-0.8740)
[2025-02-07 13:06:19,938][INFO] Epoch[21/40], loss:0.6666, CE loss:0.5991 , info NCE loss:0.4895
[2025-02-07 13:06:19,938][INFO] Epoch[21/40], train B-acc: 0.7117(0.6365-0.7912), test B-acc: 0.5781(0.5072-0.6524)
[2025-02-07 13:06:19,939][INFO] Epoch[21/40], train AUC: 0.9594(0.9307-0.9809), test AUC: 0.7931(0.7024-0.8733)
[2025-02-07 13:08:48,019][INFO] Epoch[22/40], loss:0.6661, CE loss:0.5986 , info NCE loss:0.4886
[2025-02-07 13:08:48,020][INFO] Epoch[22/40], train B-acc: 0.7849(0.7037-0.8620), test B-acc: 0.5952(0.5132-0.6783)
[2025-02-07 13:08:48,020][INFO] Epoch[22/40], train AUC: 0.9622(0.9344-0.9840), test AUC: 0.7934(0.6883-0.8754)
[2025-02-07 13:10:52,621][INFO] Epoch[23/40], loss:0.6655, CE loss:0.5981 , info NCE loss:0.4910
[2025-02-07 13:10:52,622][INFO] Epoch[23/40], train B-acc: 0.7650(0.6875-0.8366), test B-acc: 0.5672(0.4941-0.6484)
[2025-02-07 13:10:52,622][INFO] Epoch[23/40], train AUC: 0.9643(0.9388-0.9840), test AUC: 0.7948(0.6952-0.8779)
[2025-02-07 13:13:05,669][INFO] Epoch[24/40], loss:0.6646, CE loss:0.5973 , info NCE loss:0.4883
[2025-02-07 13:13:05,669][INFO] Epoch[24/40], train B-acc: 0.8106(0.7359-0.8848), test B-acc: 0.5890(0.5104-0.6917)
[2025-02-07 13:13:05,669][INFO] Epoch[24/40], train AUC: 0.9657(0.9392-0.9835), test AUC: 0.7945(0.6965-0.8788)
[2025-02-07 13:15:19,104][INFO] Epoch[25/40], loss:0.6644, CE loss:0.5970 , info NCE loss:0.4884
[2025-02-07 13:15:19,105][INFO] Epoch[25/40], train B-acc: 0.7716(0.6934-0.8423), test B-acc: 0.5719(0.4977-0.6512)
[2025-02-07 13:15:19,105][INFO] Epoch[25/40], train AUC: 0.9684(0.9426-0.9855), test AUC: 0.7955(0.6983-0.8821)
[2025-02-07 13:17:32,402][INFO] Epoch[26/40], loss:0.6636, CE loss:0.5963 , info NCE loss:0.4897
[2025-02-07 13:17:32,402][INFO] Epoch[26/40], train B-acc: 0.7535(0.6783-0.8333), test B-acc: 0.5792(0.5106-0.6640)
[2025-02-07 13:17:32,403][INFO] Epoch[26/40], train AUC: 0.9702(0.9463-0.9866), test AUC: 0.7978(0.6979-0.8780)
[2025-02-07 13:18:34,552][INFO] Epoch 27 retry 1 of 5, loss did not decrease.
[2025-02-07 13:20:34,872][INFO] Epoch[27/40], loss:0.6628, CE loss:0.5956 , info NCE loss:0.4858
[2025-02-07 13:20:34,872][INFO] Epoch[27/40], train B-acc: 0.8308(0.7563-0.8989), test B-acc: 0.6166(0.5251-0.7042)
[2025-02-07 13:20:34,874][INFO] Epoch[27/40], train AUC: 0.9727(0.9500-0.9882), test AUC: 0.7922(0.6890-0.8730)
[2025-02-07 13:22:46,181][INFO] Epoch[28/40], loss:0.6621, CE loss:0.5949 , info NCE loss:0.4875
[2025-02-07 13:22:46,181][INFO] Epoch[28/40], train B-acc: 0.8339(0.7630-0.9026), test B-acc: 0.5883(0.5035-0.6798)
[2025-02-07 13:22:46,181][INFO] Epoch[28/40], train AUC: 0.9738(0.9531-0.9890), test AUC: 0.7955(0.6943-0.8818)
[2025-02-07 13:25:12,425][INFO] Epoch[29/40], loss:0.6614, CE loss:0.5942 , info NCE loss:0.4871
[2025-02-07 13:25:12,425][INFO] Epoch[29/40], train B-acc: 0.7892(0.7083-0.8674), test B-acc: 0.5808(0.5091-0.6600)
[2025-02-07 13:25:12,426][INFO] Epoch[29/40], train AUC: 0.9758(0.9559-0.9900), test AUC: 0.7977(0.7047-0.8758)
[2025-02-07 13:26:11,935][INFO] Epoch 30 retry 1 of 5, loss did not decrease.
[2025-02-07 13:28:25,370][INFO] Epoch[30/40], loss:0.6605, CE loss:0.5933 , info NCE loss:0.4880
[2025-02-07 13:28:25,370][INFO] Epoch[30/40], train B-acc: 0.8330(0.7523-0.9040), test B-acc: 0.5982(0.5133-0.6929)
[2025-02-07 13:28:25,370][INFO] Epoch[30/40], train AUC: 0.9778(0.9581-0.9905), test AUC: 0.7867(0.6909-0.8664)
[2025-02-07 13:30:39,399][INFO] Epoch[31/40], loss:0.6600, CE loss:0.5929 , info NCE loss:0.4868
[2025-02-07 13:30:39,399][INFO] Epoch[31/40], train B-acc: 0.8356(0.7634-0.9071), test B-acc: 0.6053(0.5200-0.6971)
[2025-02-07 13:30:39,399][INFO] Epoch[31/40], train AUC: 0.9790(0.9607-0.9908), test AUC: 0.7914(0.6881-0.8759)
[2025-02-07 13:32:44,111][INFO] Epoch[32/40], loss:0.6595, CE loss:0.5924 , info NCE loss:0.4858
[2025-02-07 13:32:44,111][INFO] Epoch[32/40], train B-acc: 0.8437(0.7751-0.9065), test B-acc: 0.6340(0.5389-0.7293)
[2025-02-07 13:32:44,112][INFO] Epoch[32/40], train AUC: 0.9807(0.9653-0.9925), test AUC: 0.7910(0.6907-0.8752)
[2025-02-07 13:34:47,315][INFO] Epoch[33/40], loss:0.6589, CE loss:0.5919 , info NCE loss:0.4856
[2025-02-07 13:34:47,315][INFO] Epoch[33/40], train B-acc: 0.8341(0.7632-0.9016), test B-acc: 0.5990(0.5162-0.6878)
[2025-02-07 13:34:47,317][INFO] Epoch[33/40], train AUC: 0.9837(0.9689-0.9935), test AUC: 0.7884(0.6940-0.8662)
[2025-02-07 13:36:51,939][INFO] Epoch[34/40], loss:0.6587, CE loss:0.5917 , info NCE loss:0.4865
[2025-02-07 13:36:51,939][INFO] Epoch[34/40], train B-acc: 0.8379(0.7641-0.9070), test B-acc: 0.6140(0.5264-0.7035)
[2025-02-07 13:36:51,939][INFO] Epoch[34/40], train AUC: 0.9841(0.9699-0.9940), test AUC: 0.7875(0.6839-0.8684)
[2025-02-07 13:38:59,234][INFO] Epoch[35/40], loss:0.6581, CE loss:0.5911 , info NCE loss:0.4858
[2025-02-07 13:38:59,234][INFO] Epoch[35/40], train B-acc: 0.8457(0.7748-0.9148), test B-acc: 0.6356(0.5419-0.7295)
[2025-02-07 13:38:59,234][INFO] Epoch[35/40], train AUC: 0.9857(0.9717-0.9947), test AUC: 0.7836(0.6832-0.8710)
[2025-02-07 13:41:06,135][INFO] Epoch[36/40], loss:0.6578, CE loss:0.5909 , info NCE loss:0.4857
[2025-02-07 13:41:06,135][INFO] Epoch[36/40], train B-acc: 0.8362(0.7632-0.9054), test B-acc: 0.5961(0.5131-0.6834)
[2025-02-07 13:41:06,135][INFO] Epoch[36/40], train AUC: 0.9865(0.9747-0.9952), test AUC: 0.7849(0.6784-0.8716)
[2025-02-07 13:43:11,359][INFO] Epoch[37/40], loss:0.6574, CE loss:0.5905 , info NCE loss:0.4844
[2025-02-07 13:43:11,360][INFO] Epoch[37/40], train B-acc: 0.8390(0.7618-0.9050), test B-acc: 0.5974(0.5124-0.6859)
[2025-02-07 13:43:11,360][INFO] Epoch[37/40], train AUC: 0.9884(0.9765-0.9957), test AUC: 0.7831(0.6867-0.8656)
[2025-02-07 13:45:17,481][INFO] Epoch[38/40], loss:0.6570, CE loss:0.5900 , info NCE loss:0.4868
[2025-02-07 13:45:17,481][INFO] Epoch[38/40], train B-acc: 0.8759(0.8035-0.9333), test B-acc: 0.6261(0.5284-0.7145)
[2025-02-07 13:45:17,483][INFO] Epoch[38/40], train AUC: 0.9889(0.9776-0.9964), test AUC: 0.7775(0.6705-0.8632)
[2025-02-07 13:47:23,979][INFO] Epoch[39/40], loss:0.6562, CE loss:0.5893 , info NCE loss:0.4849
[2025-02-07 13:47:23,979][INFO] Epoch[39/40], train B-acc: 0.8730(0.8074-0.9382), test B-acc: 0.6288(0.5327-0.7196)
[2025-02-07 13:47:23,979][INFO] Epoch[39/40], train AUC: 0.9903(0.9789-0.9966), test AUC: 0.7756(0.6721-0.8643)
[2025-02-07 13:49:29,838][INFO] Epoch[40/40], loss:0.6561, CE loss:0.5892 , info NCE loss:0.4863
[2025-02-07 13:49:29,838][INFO] Epoch[40/40], train B-acc: 0.9163(0.8559-0.9667), test B-acc: 0.6378(0.5392-0.7431)
[2025-02-07 13:49:29,838][INFO] Epoch[40/40], train AUC: 0.9906(0.9803-0.9970), test AUC: 0.7751(0.6768-0.8624)
