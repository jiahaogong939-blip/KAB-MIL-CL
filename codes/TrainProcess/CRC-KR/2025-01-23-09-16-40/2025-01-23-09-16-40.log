[2025-01-23 09:16:40,925][INFO] Running PROJECT: CRC-KR, P LEARNING RATE: 0.0001, OPTIMIZER: ADAMW, NUM EPOCHS: 30, BATCH SIZE: 2048, DEVICES: cuda, SMOOTHING: 0.25
[2025-01-23 09:16:40,925][INFO] params["in_chans"]=[200, 16]python run_MIL_model.py --proj CRC-KR --num_epochs 30 --plr 1e-4  --smoothing 0.25
[2025-01-23 09:16:40,925][INFO] params["dims"]=[512, 512]温度参数为0.55
[2025-01-23 09:16:40,925][INFO] params["out_chans"]=[16, 8]
[2025-01-23 09:16:40,925][INFO] params["heads"]=[8, 4]
[2025-01-23 09:16:40,925][INFO] params["dropout"]=[0.8, 0.4, 0.4]
[2025-01-23 09:19:00,979][INFO] Epoch[1/30], loss:0.7339, CE loss:0.5644 , info NCE loss:0.5764
[2025-01-23 09:19:00,979][INFO] Epoch[1/30], train B-acc: 0.5000(0.5000-0.5000), test B-acc: 0.5000(0.5000-0.5000)
[2025-01-23 09:19:00,980][INFO] Epoch[1/30], train AUC: 0.5438(0.4442-0.6487), test AUC: 0.5324(0.4000-0.6626)
[2025-01-23 09:21:44,110][INFO] Epoch[2/30], loss:0.7107, CE loss:0.5416 , info NCE loss:0.5743
[2025-01-23 09:21:44,110][INFO] Epoch[2/30], train B-acc: 0.5000(0.5000-0.5000), test B-acc: 0.5000(0.5000-0.5000)
[2025-01-23 09:21:44,110][INFO] Epoch[2/30], train AUC: 0.7129(0.6346-0.7883), test AUC: 0.5969(0.4656-0.7283)
[2025-01-23 09:24:14,208][INFO] Epoch[3/30], loss:0.6976, CE loss:0.5293 , info NCE loss:0.5696
[2025-01-23 09:24:14,208][INFO] Epoch[3/30], train B-acc: 0.5000(0.5000-0.5000), test B-acc: 0.5000(0.5000-0.5000)
[2025-01-23 09:24:14,209][INFO] Epoch[3/30], train AUC: 0.7632(0.6783-0.8336), test AUC: 0.6562(0.5323-0.7740)
[2025-01-23 09:26:39,729][INFO] Epoch[4/30], loss:0.6887, CE loss:0.5224 , info NCE loss:0.5589
[2025-01-23 09:26:39,729][INFO] Epoch[4/30], train B-acc: 0.5116(0.5000-0.5417), test B-acc: 0.5000(0.5000-0.5000)
[2025-01-23 09:26:39,730][INFO] Epoch[4/30], train AUC: 0.7923(0.7138-0.8584), test AUC: 0.6929(0.5738-0.8056)
[2025-01-23 09:29:07,575][INFO] Epoch[5/30], loss:0.6799, CE loss:0.5171 , info NCE loss:0.5445
[2025-01-23 09:29:07,576][INFO] Epoch[5/30], train B-acc: 0.5357(0.5000-0.5814), test B-acc: 0.5000(0.5000-0.5000)
[2025-01-23 09:29:07,576][INFO] Epoch[5/30], train AUC: 0.8155(0.7471-0.8793), test AUC: 0.7177(0.5918-0.8320)
[2025-01-23 09:31:40,550][INFO] Epoch[6/30], loss:0.6707, CE loss:0.5122 , info NCE loss:0.5299
[2025-01-23 09:31:40,550][INFO] Epoch[6/30], train B-acc: 0.5333(0.4979-0.5781), test B-acc: 0.5000(0.5000-0.5000)
[2025-01-23 09:31:40,551][INFO] Epoch[6/30], train AUC: 0.8406(0.7699-0.8977), test AUC: 0.7378(0.6226-0.8443)
[2025-01-23 09:34:04,255][INFO] Epoch[7/30], loss:0.6638, CE loss:0.5076 , info NCE loss:0.5263
[2025-01-23 09:34:04,255][INFO] Epoch[7/30], train B-acc: 0.5574(0.5135-0.6169), test B-acc: 0.5156(0.5000-0.5556)
[2025-01-23 09:34:04,256][INFO] Epoch[7/30], train AUC: 0.8635(0.8015-0.9185), test AUC: 0.7439(0.6234-0.8454)
[2025-01-23 09:36:20,306][INFO] Epoch[8/30], loss:0.6579, CE loss:0.5028 , info NCE loss:0.5225
[2025-01-23 09:36:20,306][INFO] Epoch[8/30], train B-acc: 0.5811(0.5276-0.6442), test B-acc: 0.5161(0.5000-0.5600)
[2025-01-23 09:36:20,306][INFO] Epoch[8/30], train AUC: 0.8827(0.8256-0.9311), test AUC: 0.7595(0.6499-0.8616)
[2025-01-23 09:38:48,166][INFO] Epoch[9/30], loss:0.6529, CE loss:0.4987 , info NCE loss:0.5208
[2025-01-23 09:38:48,166][INFO] Epoch[9/30], train B-acc: 0.5957(0.5364-0.6601), test B-acc: 0.5156(0.5000-0.5571)
[2025-01-23 09:38:48,166][INFO] Epoch[9/30], train AUC: 0.8990(0.8448-0.9405), test AUC: 0.7653(0.6489-0.8652)
[2025-01-23 09:41:07,390][INFO] Epoch[10/30], loss:0.6487, CE loss:0.4949 , info NCE loss:0.5182
[2025-01-23 09:41:07,390][INFO] Epoch[10/30], train B-acc: 0.6190(0.5600-0.6839), test B-acc: 0.5086(0.4824-0.5556)
[2025-01-23 09:41:07,391][INFO] Epoch[10/30], train AUC: 0.9090(0.8627-0.9485), test AUC: 0.7827(0.6700-0.8784)
[2025-01-23 09:43:20,368][INFO] Epoch[11/30], loss:0.6446, CE loss:0.4912 , info NCE loss:0.5158
[2025-01-23 09:43:20,369][INFO] Epoch[11/30], train B-acc: 0.6165(0.5524-0.6837), test B-acc: 0.5086(0.4826-0.5536)
[2025-01-23 09:43:20,369][INFO] Epoch[11/30], train AUC: 0.9171(0.8735-0.9522), test AUC: 0.7862(0.6861-0.8806)
[2025-01-23 09:45:20,332][INFO] Epoch[12/30], loss:0.6406, CE loss:0.4876 , info NCE loss:0.5163
[2025-01-23 09:45:20,332][INFO] Epoch[12/30], train B-acc: 0.6169(0.5547-0.6852), test B-acc: 0.5094(0.4819-0.5504)
[2025-01-23 09:45:20,332][INFO] Epoch[12/30], train AUC: 0.9248(0.8832-0.9571), test AUC: 0.7950(0.6802-0.8902)
[2025-01-23 09:47:05,625][INFO] Epoch[13/30], loss:0.6373, CE loss:0.4845 , info NCE loss:0.5140
[2025-01-23 09:47:05,626][INFO] Epoch[13/30], train B-acc: 0.6424(0.5771-0.7145), test B-acc: 0.5419(0.4938-0.6000)
[2025-01-23 09:47:05,626][INFO] Epoch[13/30], train AUC: 0.9317(0.8914-0.9619), test AUC: 0.8004(0.6996-0.8872)
[2025-01-23 09:48:51,114][INFO] Epoch[14/30], loss:0.6343, CE loss:0.4817 , info NCE loss:0.5131
[2025-01-23 09:48:51,114][INFO] Epoch[14/30], train B-acc: 0.6400(0.5720-0.7100), test B-acc: 0.5926(0.5336-0.6719)
[2025-01-23 09:48:51,114][INFO] Epoch[14/30], train AUC: 0.9360(0.8980-0.9657), test AUC: 0.8014(0.6933-0.8875)
[2025-01-23 09:50:34,300][INFO] Epoch[15/30], loss:0.6316, CE loss:0.4791 , info NCE loss:0.5144
[2025-01-23 09:50:34,300][INFO] Epoch[15/30], train B-acc: 0.6556(0.5854-0.7299), test B-acc: 0.5909(0.5270-0.6731)
[2025-01-23 09:50:34,302][INFO] Epoch[15/30], train AUC: 0.9426(0.9046-0.9696), test AUC: 0.8007(0.7008-0.8888)
[2025-01-23 09:52:17,530][INFO] Epoch[16/30], loss:0.6291, CE loss:0.4768 , info NCE loss:0.5114
[2025-01-23 09:52:17,530][INFO] Epoch[16/30], train B-acc: 0.6987(0.6191-0.7727), test B-acc: 0.6001(0.5255-0.6874)
[2025-01-23 09:52:17,531][INFO] Epoch[16/30], train AUC: 0.9467(0.9118-0.9733), test AUC: 0.8056(0.7037-0.8975)
[2025-01-23 09:54:01,438][INFO] Epoch[17/30], loss:0.6266, CE loss:0.4743 , info NCE loss:0.5130
[2025-01-23 09:54:01,438][INFO] Epoch[17/30], train B-acc: 0.6753(0.6053-0.7501), test B-acc: 0.5929(0.5208-0.6724)
[2025-01-23 09:54:01,438][INFO] Epoch[17/30], train AUC: 0.9516(0.9196-0.9754), test AUC: 0.8052(0.7041-0.8910)
[2025-01-23 09:55:45,232][INFO] Epoch[18/30], loss:0.6241, CE loss:0.4720 , info NCE loss:0.5124
[2025-01-23 09:55:45,232][INFO] Epoch[18/30], train B-acc: 0.7245(0.6466-0.7983), test B-acc: 0.5962(0.5188-0.6845)
[2025-01-23 09:55:45,234][INFO] Epoch[18/30], train AUC: 0.9548(0.9235-0.9780), test AUC: 0.8077(0.7059-0.8957)
[2025-01-23 09:57:28,850][INFO] Epoch[19/30], loss:0.6215, CE loss:0.4695 , info NCE loss:0.5130
[2025-01-23 09:57:28,850][INFO] Epoch[19/30], train B-acc: 0.7362(0.6606-0.8091), test B-acc: 0.5972(0.5251-0.6819)
[2025-01-23 09:57:28,851][INFO] Epoch[19/30], train AUC: 0.9572(0.9261-0.9788), test AUC: 0.8094(0.7055-0.8941)
[2025-01-23 09:59:12,198][INFO] Epoch[20/30], loss:0.6199, CE loss:0.4680 , info NCE loss:0.5117
[2025-01-23 09:59:12,198][INFO] Epoch[20/30], train B-acc: 0.7737(0.6855-0.8527), test B-acc: 0.5808(0.5066-0.6722)
[2025-01-23 09:59:12,209][INFO] Epoch[20/30], train AUC: 0.9593(0.9287-0.9802), test AUC: 0.8113(0.7160-0.8911)
[2025-01-23 10:00:56,610][INFO] Epoch[21/30], loss:0.6184, CE loss:0.4665 , info NCE loss:0.5116
[2025-01-23 10:00:56,611][INFO] Epoch[21/30], train B-acc: 0.7505(0.6738-0.8202), test B-acc: 0.5906(0.5165-0.6707)
[2025-01-23 10:00:56,611][INFO] Epoch[21/30], train AUC: 0.9618(0.9337-0.9817), test AUC: 0.8117(0.7139-0.8914)
[2025-01-23 10:02:39,992][INFO] Epoch[22/30], loss:0.6175, CE loss:0.4658 , info NCE loss:0.5112
[2025-01-23 10:02:39,993][INFO] Epoch[22/30], train B-acc: 0.7758(0.7019-0.8527), test B-acc: 0.5873(0.5167-0.6770)
[2025-01-23 10:02:39,993][INFO] Epoch[22/30], train AUC: 0.9634(0.9364-0.9832), test AUC: 0.8117(0.7112-0.8921)
[2025-01-23 10:04:24,419][INFO] Epoch[23/30], loss:0.6150, CE loss:0.4634 , info NCE loss:0.5104
[2025-01-23 10:04:24,419][INFO] Epoch[23/30], train B-acc: 0.7947(0.7203-0.8703), test B-acc: 0.5829(0.5104-0.6631)
[2025-01-23 10:04:24,420][INFO] Epoch[23/30], train AUC: 0.9649(0.9392-0.9849), test AUC: 0.8100(0.7091-0.8848)
[2025-01-23 10:06:10,439][INFO] Epoch[24/30], loss:0.6127, CE loss:0.4610 , info NCE loss:0.5106
[2025-01-23 10:06:10,440][INFO] Epoch[24/30], train B-acc: 0.7994(0.7229-0.8795), test B-acc: 0.5897(0.5099-0.6707)
[2025-01-23 10:06:10,440][INFO] Epoch[24/30], train AUC: 0.9671(0.9419-0.9856), test AUC: 0.8093(0.7116-0.8897)
[2025-01-23 10:07:56,180][INFO] Epoch[25/30], loss:0.6115, CE loss:0.4599 , info NCE loss:0.5118
[2025-01-23 10:07:56,180][INFO] Epoch[25/30], train B-acc: 0.8248(0.7480-0.8927), test B-acc: 0.5825(0.5060-0.6667)
[2025-01-23 10:07:56,180][INFO] Epoch[25/30], train AUC: 0.9687(0.9445-0.9861), test AUC: 0.8127(0.7052-0.8912)
[2025-01-23 10:09:41,189][INFO] Epoch[26/30], loss:0.6100, CE loss:0.4585 , info NCE loss:0.5105
[2025-01-23 10:09:41,189][INFO] Epoch[26/30], train B-acc: 0.8211(0.7459-0.8959), test B-acc: 0.5991(0.5259-0.6929)
[2025-01-23 10:09:41,189][INFO] Epoch[26/30], train AUC: 0.9707(0.9490-0.9881), test AUC: 0.8101(0.7165-0.8936)
[2025-01-23 10:11:24,218][INFO] Epoch[27/30], loss:0.6092, CE loss:0.4578 , info NCE loss:0.5115
[2025-01-23 10:11:24,219][INFO] Epoch[27/30], train B-acc: 0.8229(0.7458-0.8984), test B-acc: 0.6043(0.5289-0.6903)
[2025-01-23 10:11:24,219][INFO] Epoch[27/30], train AUC: 0.9732(0.9519-0.9887), test AUC: 0.8060(0.7143-0.8905)
[2025-01-23 10:13:07,482][INFO] Epoch[28/30], loss:0.6072, CE loss:0.4558 , info NCE loss:0.5109
[2025-01-23 10:13:07,482][INFO] Epoch[28/30], train B-acc: 0.8451(0.7670-0.9142), test B-acc: 0.5996(0.5174-0.6886)
[2025-01-23 10:13:07,483][INFO] Epoch[28/30], train AUC: 0.9744(0.9537-0.9887), test AUC: 0.8042(0.7078-0.8884)
[2025-01-23 10:14:50,308][INFO] Epoch[29/30], loss:0.6058, CE loss:0.4545 , info NCE loss:0.5097
[2025-01-23 10:14:50,310][INFO] Epoch[29/30], train B-acc: 0.8407(0.7651-0.9086), test B-acc: 0.6551(0.5691-0.7484)
[2025-01-23 10:14:50,310][INFO] Epoch[29/30], train AUC: 0.9750(0.9534-0.9901), test AUC: 0.8034(0.7141-0.8843)
[2025-01-23 10:16:33,112][INFO] Epoch[30/30], loss:0.6046, CE loss:0.4533 , info NCE loss:0.5100
[2025-01-23 10:16:33,112][INFO] Epoch[30/30], train B-acc: 0.8362(0.7653-0.9087), test B-acc: 0.6017(0.5144-0.6990)
[2025-01-23 10:16:33,112][INFO] Epoch[30/30], train AUC: 0.9773(0.9587-0.9914), test AUC: 0.8049(0.6977-0.8940)
